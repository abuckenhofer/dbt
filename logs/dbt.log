

============================== 2022-11-25 15:32:49.541515 | 0c0d78ed-f41c-446b-a958-6fad7b16579e ==============================
[0m15:32:49.541515 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:32:49.542513 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m15:32:49.542513 [debug] [MainThread]: Tracking: tracking
[0m15:32:49.562465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193303DBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193303DBFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193303DBF10>]}
[0m15:32:49.665204 [debug] [MainThread]: Executing "git --help"
[0m15:32:58.444508 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:32:58.444508 [debug] [MainThread]: STDERR: "b''"
[0m15:32:58.450247 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m15:32:58.451244 [debug] [MainThread]: Using postgres connection "debug"
[0m15:32:58.451244 [debug] [MainThread]: On debug: select 1 as id
[0m15:32:58.451244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:58.505107 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:

[0m15:32:58.552988 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:32:58.552988 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:32:58.553986 [debug] [MainThread]: On debug: No close available on handle
[0m15:32:58.556978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193304D5E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193304D4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193304D4CD0>]}
[0m15:32:58.556978 [debug] [MainThread]: Flushing usage events
[0m15:33:03.822869 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:33:03.823866 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-25 15:34:34.298196 | 1accd9d3-0207-4fb8-a56e-718010e5564c ==============================
[0m15:34:34.298196 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:34:34.298196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m15:34:34.299193 [debug] [MainThread]: Tracking: tracking
[0m15:34:34.320141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA6E87D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA6E87DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA6EB46D0>]}
[0m15:34:34.386975 [debug] [MainThread]: Executing "git --help"
[0m15:34:44.459060 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:34:44.460081 [debug] [MainThread]: STDERR: "b''"
[0m15:34:44.466013 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m15:34:44.467009 [debug] [MainThread]: Using postgres connection "debug"
[0m15:34:44.467009 [debug] [MainThread]: On debug: select 1 as id
[0m15:34:44.468007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:44.525446 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
[0m15:34:44.526458 [debug] [MainThread]: On debug: Close
[0m15:34:44.529439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA6F85720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA6F86230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA6F87D60>]}
[0m15:34:44.530434 [debug] [MainThread]: Flushing usage events
[0m15:34:45.171495 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:34:45.171495 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-25 15:40:12.094795 | bae5d3ef-784b-4c3d-9046-3859821860d9 ==============================
[0m15:40:12.094795 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:40:12.095787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:40:12.095787 [debug] [MainThread]: Tracking: tracking
[0m15:40:12.123799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74E47D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74E461D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74E44D90>]}
[0m15:40:12.142786 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m15:40:12.143786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74F41CC0>]}
[0m15:40:12.573783 [debug] [MainThread]: Parsing macros\adapters.sql
[0m15:40:12.592816 [debug] [MainThread]: Parsing macros\catalog.sql
[0m15:40:12.595825 [debug] [MainThread]: Parsing macros\relations.sql
[0m15:40:12.596817 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m15:40:12.597816 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m15:40:12.598827 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m15:40:12.600815 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m15:40:12.600815 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m15:40:12.601784 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m15:40:12.606820 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m15:40:12.607814 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m15:40:12.608784 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m15:40:12.609820 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m15:40:12.620817 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m15:40:12.628816 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m15:40:12.629817 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m15:40:12.631817 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m15:40:12.637819 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m15:40:12.641819 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m15:40:12.652443 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m15:40:12.654397 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m15:40:12.657398 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m15:40:12.664401 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m15:40:12.668400 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m15:40:12.670366 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m15:40:12.670366 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m15:40:12.671365 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m15:40:12.672406 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m15:40:12.673398 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m15:40:12.675400 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m15:40:12.677366 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m15:40:12.679403 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m15:40:12.682395 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m15:40:12.688397 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m15:40:12.696401 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m15:40:12.697365 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m15:40:12.709404 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m15:40:12.722397 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m15:40:12.728401 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m15:40:12.731397 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m15:40:12.735398 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m15:40:12.738397 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m15:40:12.740397 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m15:40:12.741366 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m15:40:12.745397 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m15:40:12.759397 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m15:40:12.765437 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m15:40:12.775578 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m15:40:12.785702 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m15:40:12.787668 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m15:40:12.801693 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m15:40:12.803723 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m15:40:12.806726 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m15:40:12.808723 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m15:40:12.813722 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m15:40:12.814734 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m15:40:12.815733 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m15:40:12.816733 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m15:40:12.818769 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m15:40:12.818769 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m15:40:12.819766 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m15:40:12.820763 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m15:40:12.835311 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m15:40:12.836312 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m15:40:12.837312 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m15:40:12.838311 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m15:40:12.839312 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m15:40:12.840311 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m15:40:12.841312 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m15:40:12.842312 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m15:40:12.844337 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m15:40:12.845312 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m15:40:12.847311 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m15:40:12.848312 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m15:40:12.849312 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m15:40:12.850312 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m15:40:12.851312 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m15:40:12.852311 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m15:40:12.853312 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m15:40:13.060406 [debug] [MainThread]: 1603: static parser failed on mart\d_customer_incremental_prs.sql
[0m15:40:13.074915 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mart\d_customer_incremental_prs.sql
[0m15:40:13.077930 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_table_prs.sql
[0m15:40:13.081082 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_view_prs.sql
[0m15:40:13.135080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m15:40:13.141079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C7506CFD0>]}
[0m15:40:13.150080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74F43550>]}
[0m15:40:13.150080 [info ] [MainThread]: Found 3 models, 0 tests, 1 snapshot, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m15:40:13.151080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74FB6B90>]}
[0m15:40:13.152080 [info ] [MainThread]: 
[0m15:40:13.153080 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:40:13.155080 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:40:13.164113 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:40:13.165115 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:40:13.165115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:13.308134 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.14 seconds
[0m15:40:13.309169 [debug] [ThreadPool]: On list_postgres: Close
[0m15:40:13.311134 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m15:40:13.316167 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:40:13.317169 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m15:40:13.317169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:13.372134 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m15:40:13.372134 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:40:13.373135 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m15:40:13.381141 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:40:13.382138 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m15:40:13.382138 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m15:40:13.387133 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:13.387133 [debug] [MainThread]: On master: BEGIN
[0m15:40:13.388134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:13.441133 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:40:13.441133 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:13.442133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:40:13.481168 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m15:40:13.482135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C75133CA0>]}
[0m15:40:13.483134 [debug] [MainThread]: On master: ROLLBACK
[0m15:40:13.483134 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:13.483134 [debug] [MainThread]: On master: BEGIN
[0m15:40:13.484134 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:40:13.484134 [debug] [MainThread]: On master: COMMIT
[0m15:40:13.485134 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:13.485134 [debug] [MainThread]: On master: COMMIT
[0m15:40:13.485134 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:40:13.486134 [debug] [MainThread]: On master: Close
[0m15:40:13.486134 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m15:40:13.487134 [info ] [MainThread]: 
[0m15:40:13.499134 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m15:40:13.499134 [info ] [Thread-1 (]: 1 of 3 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m15:40:13.500133 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:40:13.500133 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m15:40:13.500133 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m15:40:13.504134 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m15:40:13.508135 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:13.508135 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m15:40:13.553135 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m15:40:13.556143 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:40:13.557134 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m15:40:13.557134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:13.608134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:40:13.608134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:40:13.608134 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_prs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."abu.stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m15:40:13.609135 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
LINE 13:     from "postgres"."abu"."abu.stg_customer_trs"
                  ^

[0m15:40:13.609135 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: ROLLBACK
[0m15:40:13.610135 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:13.610135 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m15:40:13.611136 [debug] [Thread-1 (]: Database Error in model d_customer_incremental_prs (models\mart\d_customer_incremental_prs.sql)
  FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
  LINE 13:     from "postgres"."abu"."abu.stg_customer_trs"
                    ^
  compiled Code at target\run\scenarios\models\mart\d_customer_incremental_prs.sql
[0m15:40:13.612134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C75077F70>]}
[0m15:40:13.612134 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model abu.d_customer_incremental_prs ..... [[31mERROR[0m in 0.11s]
[0m15:40:13.614135 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m15:40:13.614135 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m15:40:13.615164 [info ] [Thread-1 (]: 2 of 3 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m15:40:13.616165 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m15:40:13.616165 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m15:40:13.616165 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m15:40:13.619169 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m15:40:13.621133 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:13.621133 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m15:40:13.632136 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m15:40:13.634168 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:40:13.634168 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m15:40:13.634168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:13.688134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:40:13.688134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:40:13.689169 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."abu.stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m15:40:13.689169 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
LINE 12:     from "postgres"."abu"."abu.stg_customer_trs"
                  ^

[0m15:40:13.690172 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: ROLLBACK
[0m15:40:13.690172 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:13.690172 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m15:40:13.691168 [debug] [Thread-1 (]: Database Error in model d_customer_table_prs (models\mart\d_customer_table_prs.sql)
  FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
  LINE 12:     from "postgres"."abu"."abu.stg_customer_trs"
                    ^
  compiled Code at target\run\scenarios\models\mart\d_customer_table_prs.sql
[0m15:40:13.691168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C750662F0>]}
[0m15:40:13.692134 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model abu.d_customer_table_prs ................. [[31mERROR[0m in 0.08s]
[0m15:40:13.694135 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m15:40:13.694135 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m15:40:13.694135 [info ] [Thread-1 (]: 3 of 3 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m15:40:13.696134 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m15:40:13.696134 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m15:40:13.696134 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m15:40:13.699134 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m15:40:13.700133 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:13.701135 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m15:40:13.716169 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m15:40:13.718146 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:40:13.718146 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m15:40:13.719135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:13.774134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:40:13.775136 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:40:13.775136 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."abu.stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m15:40:13.776137 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
LINE 8:     from "postgres"."abu"."abu.stg_customer_trs"
                 ^

[0m15:40:13.777135 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: ROLLBACK
[0m15:40:13.777135 [debug] [Thread-1 (]: finished collecting timing info
[0m15:40:13.777135 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m15:40:13.778136 [debug] [Thread-1 (]: Database Error in model d_customer_view_prs (models\mart\d_customer_view_prs.sql)
  FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
  LINE 8:     from "postgres"."abu"."abu.stg_customer_trs"
                   ^
  compiled Code at target\run\scenarios\models\mart\d_customer_view_prs.sql
[0m15:40:13.779134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae5d3ef-784b-4c3d-9046-3859821860d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C75066B30>]}
[0m15:40:13.779134 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model abu.d_customer_view_prs ................... [[31mERROR[0m in 0.08s]
[0m15:40:13.781134 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m15:40:13.782135 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:40:13.782135 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:13.783135 [debug] [MainThread]: On master: BEGIN
[0m15:40:13.783135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:13.841134 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m15:40:13.842135 [debug] [MainThread]: On master: COMMIT
[0m15:40:13.842135 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:13.842135 [debug] [MainThread]: On master: COMMIT
[0m15:40:13.843148 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:40:13.843148 [debug] [MainThread]: On master: Close
[0m15:40:13.845134 [info ] [MainThread]: 
[0m15:40:13.846134 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m15:40:13.848134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:13.848134 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:40:13.848134 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m15:40:13.849134 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_prs' was properly closed.
[0m15:40:13.889135 [info ] [MainThread]: 
[0m15:40:13.890134 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m15:40:13.892135 [info ] [MainThread]: 
[0m15:40:13.893135 [error] [MainThread]: [33mDatabase Error in model d_customer_incremental_prs (models\mart\d_customer_incremental_prs.sql)[0m
[0m15:40:13.900141 [error] [MainThread]:   FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
[0m15:40:13.901135 [error] [MainThread]:   LINE 13:     from "postgres"."abu"."abu.stg_customer_trs"
[0m15:40:13.901135 [error] [MainThread]:                     ^
[0m15:40:13.904135 [error] [MainThread]:   compiled Code at target\run\scenarios\models\mart\d_customer_incremental_prs.sql
[0m15:40:13.912134 [info ] [MainThread]: 
[0m15:40:13.912134 [error] [MainThread]: [33mDatabase Error in model d_customer_table_prs (models\mart\d_customer_table_prs.sql)[0m
[0m15:40:13.913134 [error] [MainThread]:   FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
[0m15:40:13.913134 [error] [MainThread]:   LINE 12:     from "postgres"."abu"."abu.stg_customer_trs"
[0m15:40:13.914134 [error] [MainThread]:                     ^
[0m15:40:13.914134 [error] [MainThread]:   compiled Code at target\run\scenarios\models\mart\d_customer_table_prs.sql
[0m15:40:13.915134 [info ] [MainThread]: 
[0m15:40:13.916155 [error] [MainThread]: [33mDatabase Error in model d_customer_view_prs (models\mart\d_customer_view_prs.sql)[0m
[0m15:40:13.916155 [error] [MainThread]:   FEHLER:  Relation Â»abu.abu.stg_customer_trsÂ« existiert nicht
[0m15:40:13.917134 [error] [MainThread]:   LINE 8:     from "postgres"."abu"."abu.stg_customer_trs"
[0m15:40:13.917134 [error] [MainThread]:                    ^
[0m15:40:13.921135 [error] [MainThread]:   compiled Code at target\run\scenarios\models\mart\d_customer_view_prs.sql
[0m15:40:13.927134 [info ] [MainThread]: 
[0m15:40:13.928137 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m15:40:13.929135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74EFA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74EFBFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C74F29E40>]}
[0m15:40:13.929135 [debug] [MainThread]: Flushing usage events
[0m15:40:21.301860 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 14:19:32.284211 | f3df1bc9-945d-4b7f-8c72-31ff88e44459 ==============================
[0m14:19:32.284211 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:19:32.285212 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m14:19:32.285212 [debug] [MainThread]: Tracking: tracking
[0m14:19:32.305212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27E757D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27E757DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27E7886D0>]}
[0m14:19:32.387216 [debug] [MainThread]: Executing "git --help"
[0m14:19:32.466221 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:19:32.467221 [debug] [MainThread]: STDERR: "b''"
[0m14:19:32.473221 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m14:19:32.474221 [debug] [MainThread]: Using postgres connection "debug"
[0m14:19:32.474221 [debug] [MainThread]: On debug: select 1 as id
[0m14:19:32.474221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:32.541224 [debug] [MainThread]: SQL status: SELECT 1 in 0.07 seconds
[0m14:19:32.542224 [debug] [MainThread]: On debug: Close
[0m14:19:32.545224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27E855720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27E856230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F27E857D60>]}
[0m14:19:32.545224 [debug] [MainThread]: Flushing usage events
[0m14:19:33.062208 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m14:19:33.063210 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-27 14:25:52.861196 | 32b4397f-cb2b-4fff-9e42-66f68f9c705a ==============================
[0m14:25:52.861196 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:25:52.861196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m14:25:52.862156 [debug] [MainThread]: Tracking: tracking
[0m14:25:52.882158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002723A46BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002723A46BDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002723A4986D0>]}
[0m14:25:52.949185 [debug] [MainThread]: Executing "git --help"
[0m14:25:53.040156 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:25:53.041157 [debug] [MainThread]: STDERR: "b''"
[0m14:25:53.046157 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m14:25:53.047159 [debug] [MainThread]: Using postgres connection "debug"
[0m14:25:53.047159 [debug] [MainThread]: On debug: select 1 as id
[0m14:25:53.047159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:53.106157 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
[0m14:25:53.107156 [debug] [MainThread]: On debug: Close
[0m14:25:53.109156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002723A565720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002723A566230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002723A567D60>]}
[0m14:25:53.110158 [debug] [MainThread]: Flushing usage events
[0m14:26:04.183884 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m14:26:04.185881 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-27 14:26:15.352084 | 83e1c2ca-63fc-4742-a3ff-4e400c71e25c ==============================
[0m14:26:15.352084 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:26:15.352084 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:26:15.353085 [debug] [MainThread]: Tracking: tracking
[0m14:26:15.374085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F31F7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F31F61D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F31F4D90>]}
[0m14:26:15.488197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 5 files changed.
[0m14:26:15.488197 [debug] [MainThread]: Partial parsing: added file: scenarios://models\mart\d_customer_incremental_trs.sql
[0m14:26:15.488197 [debug] [MainThread]: Partial parsing: added file: scenarios://snapshots\d_customer_snapshot_trs.sql
[0m14:26:15.489197 [debug] [MainThread]: Partial parsing: added file: scenarios://models\mart\d_customer_table_trs.sql
[0m14:26:15.489197 [debug] [MainThread]: Partial parsing: added file: scenarios://models\mart\d_customer_view_trs.sql
[0m14:26:15.490197 [debug] [MainThread]: Partial parsing: deleted source source.scenarios.abu.abu.stg_customer_prs
[0m14:26:15.490197 [debug] [MainThread]: Partial parsing: deleted source source.scenarios.abu.abu.stg_customer_trs
[0m14:26:15.490197 [debug] [MainThread]: Partial parsing: update schema file: scenarios://models\staging\sources.yml
[0m14:26:15.491197 [debug] [MainThread]: Partial parsing: updated file: scenarios://models\mart\d_customer_table_prs.sql
[0m14:26:15.491197 [debug] [MainThread]: Partial parsing: updated file: scenarios://models\mart\d_customer_view_prs.sql
[0m14:26:15.491197 [debug] [MainThread]: Partial parsing: updated file: scenarios://models\mart\d_customer_incremental_prs.sql
[0m14:26:15.492197 [debug] [MainThread]: Partial parsing: updated file: scenarios://snapshots\d_customer_snapshot_prs.sql
[0m14:26:15.502197 [debug] [MainThread]: 1603: static parser failed on mart\d_customer_incremental_trs.sql
[0m14:26:15.516233 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mart\d_customer_incremental_trs.sql
[0m14:26:15.519198 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_table_trs.sql
[0m14:26:15.523195 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_view_trs.sql
[0m14:26:15.525194 [debug] [MainThread]: 1603: static parser failed on mart\d_customer_incremental_prs.sql
[0m14:26:15.529227 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mart\d_customer_incremental_prs.sql
[0m14:26:15.530225 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_table_prs.sql
[0m14:26:15.533196 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_view_prs.sql
[0m14:26:15.574203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m14:26:15.578973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F34A5A50>]}
[0m14:26:15.586013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F3422E60>]}
[0m14:26:15.587014 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m14:26:15.588015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F348BC10>]}
[0m14:26:15.589015 [info ] [MainThread]: 
[0m14:26:15.590017 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:26:15.592046 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m14:26:15.601047 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:26:15.601047 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:26:15.601047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:15.662014 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m14:26:15.663049 [debug] [ThreadPool]: On list_postgres: Close
[0m14:26:15.665014 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m14:26:15.671015 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m14:26:15.671015 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m14:26:15.671015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:15.725014 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m14:26:15.725014 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m14:26:15.726025 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m14:26:15.733014 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m14:26:15.734015 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m14:26:15.735020 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m14:26:15.739013 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.740014 [debug] [MainThread]: On master: BEGIN
[0m14:26:15.740014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:15.791013 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m14:26:15.791013 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.791013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:26:15.829012 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m14:26:15.831015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F3420790>]}
[0m14:26:15.831015 [debug] [MainThread]: On master: ROLLBACK
[0m14:26:15.831015 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.832014 [debug] [MainThread]: On master: BEGIN
[0m14:26:15.832014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:26:15.833014 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.833014 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.833014 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.834014 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:26:15.834014 [debug] [MainThread]: On master: Close
[0m14:26:15.835014 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m14:26:15.835014 [info ] [MainThread]: 
[0m14:26:15.846014 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m14:26:15.847014 [info ] [Thread-1 (]: 1 of 6 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m14:26:15.848013 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m14:26:15.848013 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m14:26:15.848013 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m14:26:15.852014 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m14:26:15.855015 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:15.855015 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m14:26:15.901048 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m14:26:15.904033 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m14:26:15.904033 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m14:26:15.904033 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:26:15.957031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m14:26:15.957031 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m14:26:15.957031 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_prs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m14:26:15.958030 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
LINE 13:     from "postgres"."abu"."stg_customer_prs"
                  ^

[0m14:26:15.958030 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: ROLLBACK
[0m14:26:15.959031 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:15.959031 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m14:26:15.960030 [debug] [Thread-1 (]: Database Error in model d_customer_incremental_prs (models\mart\d_customer_incremental_prs.sql)
  FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
  LINE 13:     from "postgres"."abu"."stg_customer_prs"
                    ^
  compiled Code at target\run\scenarios\models\mart\d_customer_incremental_prs.sql
[0m14:26:15.960030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F3586CB0>]}
[0m14:26:15.961031 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model abu.d_customer_incremental_prs ..... [[31mERROR[0m in 0.11s]
[0m14:26:15.962031 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m14:26:15.962031 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_trs
[0m14:26:15.963031 [info ] [Thread-1 (]: 2 of 6 START sql incremental model abu.d_customer_incremental_trs .............. [RUN]
[0m14:26:15.963031 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_trs"
[0m14:26:15.964031 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_trs
[0m14:26:15.964031 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_trs
[0m14:26:15.967030 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_trs"
[0m14:26:15.968030 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:15.969030 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_trs
[0m14:26:15.973030 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_trs"
[0m14:26:15.974031 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m14:26:15.975031 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: BEGIN
[0m14:26:15.975031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:16.027062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m14:26:16.028030 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m14:26:16.028030 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_trs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m14:26:16.033029 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:26:16.050028 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m14:26:16.050028 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m14:26:16.051030 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m14:26:16.052029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:26:16.052029 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.053032 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: Close
[0m14:26:16.053032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F3586CB0>]}
[0m14:26:16.054032 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model abu.d_customer_incremental_trs ......... [[32mSELECT 2[0m in 0.09s]
[0m14:26:16.056042 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_trs
[0m14:26:16.057031 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m14:26:16.057031 [info ] [Thread-1 (]: 3 of 6 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m14:26:16.058039 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m14:26:16.058039 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m14:26:16.059032 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m14:26:16.061031 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m14:26:16.062031 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.062031 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m14:26:16.075032 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m14:26:16.077032 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m14:26:16.077032 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m14:26:16.077032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:16.131544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m14:26:16.131544 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m14:26:16.132544 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m14:26:16.132544 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
LINE 12:     from "postgres"."abu"."stg_customer_prs"
                  ^

[0m14:26:16.133545 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: ROLLBACK
[0m14:26:16.133545 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.134547 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m14:26:16.135547 [debug] [Thread-1 (]: Database Error in model d_customer_table_prs (models\mart\d_customer_table_prs.sql)
  FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
  LINE 12:     from "postgres"."abu"."stg_customer_prs"
                    ^
  compiled Code at target\run\scenarios\models\mart\d_customer_table_prs.sql
[0m14:26:16.135547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F3587310>]}
[0m14:26:16.136546 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model abu.d_customer_table_prs ................. [[31mERROR[0m in 0.08s]
[0m14:26:16.137545 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m14:26:16.138545 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_trs
[0m14:26:16.138545 [info ] [Thread-1 (]: 4 of 6 START sql table model abu.d_customer_table_trs .......................... [RUN]
[0m14:26:16.139547 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_trs"
[0m14:26:16.139547 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_trs
[0m14:26:16.140546 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_trs
[0m14:26:16.142546 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_trs"
[0m14:26:16.144547 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.144547 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_trs
[0m14:26:16.148546 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_trs"
[0m14:26:16.150547 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m14:26:16.150547 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: BEGIN
[0m14:26:16.150547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:16.206543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m14:26:16.207543 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m14:26:16.207543 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_trs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m14:26:16.212542 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:26:16.217545 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m14:26:16.217545 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs__dbt_tmp" rename to "d_customer_table_trs"
[0m14:26:16.218546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:26:16.220546 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m14:26:16.221546 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m14:26:16.221546 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m14:26:16.222578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:26:16.226546 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m14:26:16.226546 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
drop table if exists "postgres"."abu"."d_customer_table_trs__dbt_backup" cascade
[0m14:26:16.227546 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:26:16.228546 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.228546 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: Close
[0m14:26:16.229546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F3587220>]}
[0m14:26:16.230546 [info ] [Thread-1 (]: 4 of 6 OK created sql table model abu.d_customer_table_trs ..................... [[32mSELECT 2[0m in 0.09s]
[0m14:26:16.232545 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_trs
[0m14:26:16.232545 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m14:26:16.233546 [info ] [Thread-1 (]: 5 of 6 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m14:26:16.233546 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m14:26:16.234547 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m14:26:16.234547 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m14:26:16.237546 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m14:26:16.238547 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.238547 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m14:26:16.254545 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m14:26:16.255546 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m14:26:16.256548 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m14:26:16.256548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:16.308542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m14:26:16.308542 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m14:26:16.308542 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m14:26:16.309543 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
LINE 8:     from "postgres"."abu"."stg_customer_prs"
                 ^

[0m14:26:16.310544 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: ROLLBACK
[0m14:26:16.310544 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.310544 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m14:26:16.311543 [debug] [Thread-1 (]: Database Error in model d_customer_view_prs (models\mart\d_customer_view_prs.sql)
  FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
  LINE 8:     from "postgres"."abu"."stg_customer_prs"
                   ^
  compiled Code at target\run\scenarios\models\mart\d_customer_view_prs.sql
[0m14:26:16.311543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F34735E0>]}
[0m14:26:16.312543 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model abu.d_customer_view_prs ................... [[31mERROR[0m in 0.08s]
[0m14:26:16.314546 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m14:26:16.314546 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_trs
[0m14:26:16.314546 [info ] [Thread-1 (]: 6 of 6 START sql view model abu.d_customer_view_trs ............................ [RUN]
[0m14:26:16.315546 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_trs"
[0m14:26:16.315546 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_trs
[0m14:26:16.316546 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_trs
[0m14:26:16.318546 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_trs"
[0m14:26:16.320546 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.320546 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_trs
[0m14:26:16.325545 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_trs"
[0m14:26:16.326559 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m14:26:16.327546 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: BEGIN
[0m14:26:16.327546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:16.379544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m14:26:16.380543 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m14:26:16.380543 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */

  create view "postgres"."abu"."d_customer_view_trs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m14:26:16.384543 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:26:16.387543 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m14:26:16.387543 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs__dbt_tmp" rename to "d_customer_view_trs"
[0m14:26:16.388543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:26:16.390544 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m14:26:16.390544 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m14:26:16.390544 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m14:26:16.392543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:26:16.394543 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m14:26:16.394543 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
drop view if exists "postgres"."abu"."d_customer_view_trs__dbt_backup" cascade
[0m14:26:16.395543 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:26:16.396573 [debug] [Thread-1 (]: finished collecting timing info
[0m14:26:16.396573 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: Close
[0m14:26:16.397543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e1c2ca-63fc-4742-a3ff-4e400c71e25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F366A650>]}
[0m14:26:16.397543 [info ] [Thread-1 (]: 6 of 6 OK created sql view model abu.d_customer_view_trs ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:26:16.399559 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_trs
[0m14:26:16.400546 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m14:26:16.401544 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:16.401544 [debug] [MainThread]: On master: BEGIN
[0m14:26:16.401544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:16.458543 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m14:26:16.459544 [debug] [MainThread]: On master: COMMIT
[0m14:26:16.459544 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:16.459544 [debug] [MainThread]: On master: COMMIT
[0m14:26:16.460543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:26:16.460543 [debug] [MainThread]: On master: Close
[0m14:26:16.462543 [info ] [MainThread]: 
[0m14:26:16.463543 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m14:26:16.465544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:16.466543 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:26:16.466543 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m14:26:16.466543 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_trs' was properly closed.
[0m14:26:16.474543 [info ] [MainThread]: 
[0m14:26:16.475544 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:26:16.475544 [info ] [MainThread]: 
[0m14:26:16.476543 [error] [MainThread]: [33mDatabase Error in model d_customer_incremental_prs (models\mart\d_customer_incremental_prs.sql)[0m
[0m14:26:16.477543 [error] [MainThread]:   FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
[0m14:26:16.477543 [error] [MainThread]:   LINE 13:     from "postgres"."abu"."stg_customer_prs"
[0m14:26:16.478542 [error] [MainThread]:                     ^
[0m14:26:16.478542 [error] [MainThread]:   compiled Code at target\run\scenarios\models\mart\d_customer_incremental_prs.sql
[0m14:26:16.479543 [info ] [MainThread]: 
[0m14:26:16.479543 [error] [MainThread]: [33mDatabase Error in model d_customer_table_prs (models\mart\d_customer_table_prs.sql)[0m
[0m14:26:16.480543 [error] [MainThread]:   FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
[0m14:26:16.480543 [error] [MainThread]:   LINE 12:     from "postgres"."abu"."stg_customer_prs"
[0m14:26:16.481543 [error] [MainThread]:                     ^
[0m14:26:16.481543 [error] [MainThread]:   compiled Code at target\run\scenarios\models\mart\d_customer_table_prs.sql
[0m14:26:16.484542 [info ] [MainThread]: 
[0m14:26:16.491544 [error] [MainThread]: [33mDatabase Error in model d_customer_view_prs (models\mart\d_customer_view_prs.sql)[0m
[0m14:26:16.492544 [error] [MainThread]:   FEHLER:  Relation Â»abu.stg_customer_prsÂ« existiert nicht
[0m14:26:16.493543 [error] [MainThread]:   LINE 8:     from "postgres"."abu"."stg_customer_prs"
[0m14:26:16.493543 [error] [MainThread]:                    ^
[0m14:26:16.493543 [error] [MainThread]:   compiled Code at target\run\scenarios\models\mart\d_customer_view_prs.sql
[0m14:26:16.494543 [info ] [MainThread]: 
[0m14:26:16.495543 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m14:26:16.495543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F34EA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F36B36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F3652410>]}
[0m14:26:16.496543 [debug] [MainThread]: Flushing usage events


============================== 2022-11-27 14:32:47.564223 | 4ec306a5-c90b-493b-b2cf-e9da9f31a59f ==============================
[0m14:32:47.565222 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:32:47.565222 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m14:32:47.566221 [debug] [MainThread]: Tracking: tracking
[0m14:32:47.586221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465D027FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465D058790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465D0589A0>]}
[0m14:32:47.676200 [debug] [MainThread]: Executing "git --help"
[0m14:32:47.754172 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:32:47.755178 [debug] [MainThread]: STDERR: "b''"
[0m14:32:47.760667 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m14:32:47.760667 [debug] [MainThread]: Using postgres connection "debug"
[0m14:32:47.761668 [debug] [MainThread]: On debug: select 1 as id
[0m14:32:47.761668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:47.817667 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
[0m14:32:47.818667 [debug] [MainThread]: On debug: Close
[0m14:32:47.821669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465D127CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465D126230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002465D125660>]}
[0m14:32:47.822668 [debug] [MainThread]: Flushing usage events
[0m14:32:48.088809 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m14:32:48.089806 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-27 15:27:43.439890 | 8c544fbe-d655-4b8e-8c18-ca1c28388778 ==============================
[0m15:27:43.440891 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:27:43.440891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:27:43.441899 [debug] [MainThread]: Tracking: tracking
[0m15:27:43.461899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FB07D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FB061A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FB04D60>]}
[0m15:27:43.502891 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m15:27:43.503891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CFE7940>]}
[0m15:27:43.885464 [debug] [MainThread]: Parsing macros\adapters.sql
[0m15:27:43.903463 [debug] [MainThread]: Parsing macros\catalog.sql
[0m15:27:43.904464 [debug] [MainThread]: Parsing macros\relations.sql
[0m15:27:43.906464 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m15:27:43.907464 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m15:27:43.908463 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m15:27:43.910463 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m15:27:43.910463 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m15:27:43.911463 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m15:27:43.916463 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m15:27:43.917464 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m15:27:43.919464 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m15:27:43.920464 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m15:27:43.930463 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m15:27:43.937463 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m15:27:43.939463 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m15:27:43.942463 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m15:27:43.947463 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m15:27:43.951463 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m15:27:43.962463 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m15:27:43.964463 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m15:27:43.967482 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m15:27:43.974463 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m15:27:43.978463 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m15:27:43.979463 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m15:27:43.980463 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m15:27:43.981463 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m15:27:43.982463 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m15:27:43.983464 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m15:27:43.985463 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m15:27:43.987463 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m15:27:43.989463 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m15:27:43.992463 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m15:27:43.998463 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m15:27:44.006463 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m15:27:44.008466 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m15:27:44.019024 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m15:27:44.031978 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m15:27:44.036978 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m15:27:44.039978 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m15:27:44.044978 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m15:27:44.046978 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m15:27:44.048979 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m15:27:44.049978 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m15:27:44.054978 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m15:27:44.068978 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m15:27:44.073979 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m15:27:44.082979 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m15:27:44.091978 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m15:27:44.093979 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m15:27:44.106976 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m15:27:44.107977 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m15:27:44.111976 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m15:27:44.112977 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m15:27:44.117977 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m15:27:44.119978 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m15:27:44.120977 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m15:27:44.121977 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m15:27:44.123977 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m15:27:44.124978 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m15:27:44.125977 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m15:27:44.126996 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m15:27:44.140977 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m15:27:44.142977 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m15:27:44.143977 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m15:27:44.144977 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m15:27:44.146977 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m15:27:44.147977 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m15:27:44.148978 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m15:27:44.149977 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m15:27:44.151981 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m15:27:44.152977 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m15:27:44.154977 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m15:27:44.156978 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m15:27:44.157991 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m15:27:44.158977 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m15:27:44.159977 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m15:27:44.160978 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m15:27:44.162977 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m15:27:44.361530 [debug] [MainThread]: 1603: static parser failed on mart\d_customer_incremental_prs.sql
[0m15:27:44.374550 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mart\d_customer_incremental_prs.sql
[0m15:27:44.376550 [debug] [MainThread]: 1603: static parser failed on mart\d_customer_incremental_trs.sql
[0m15:27:44.379550 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mart\d_customer_incremental_trs.sql
[0m15:27:44.383095 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_table_prs.sql
[0m15:27:44.385094 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_table_trs.sql
[0m15:27:44.388129 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_view_prs.sql
[0m15:27:44.391122 [debug] [MainThread]: 1699: static parser successfully parsed mart\d_customer_view_trs.sql
[0m15:27:44.448322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m15:27:44.454316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FE0A410>]}
[0m15:27:44.461345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FCB93F0>]}
[0m15:27:44.461345 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m15:27:44.462316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FB04D60>]}
[0m15:27:44.463316 [info ] [MainThread]: 
[0m15:27:44.464331 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:27:44.466344 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:27:44.477344 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:27:44.477344 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:27:44.477344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:44.538316 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m15:27:44.539316 [debug] [ThreadPool]: On list_postgres: Close
[0m15:27:44.541317 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m15:27:44.546318 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:27:44.546318 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m15:27:44.546318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:44.599316 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m15:27:44.599316 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:27:44.599316 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m15:27:44.606316 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:27:44.607317 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m15:27:44.607317 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m15:27:44.613315 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:44.613315 [debug] [MainThread]: On master: BEGIN
[0m15:27:44.613315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:44.664316 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:27:44.664316 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:44.664316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:44.702315 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m15:27:44.703346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FE43310>]}
[0m15:27:44.703346 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:44.704349 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:44.704349 [debug] [MainThread]: On master: BEGIN
[0m15:27:44.705326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:27:44.705326 [debug] [MainThread]: On master: COMMIT
[0m15:27:44.705326 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:44.706349 [debug] [MainThread]: On master: COMMIT
[0m15:27:44.706349 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:27:44.706349 [debug] [MainThread]: On master: Close
[0m15:27:44.707317 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m15:27:44.708316 [info ] [MainThread]: 
[0m15:27:44.755316 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m15:27:44.756317 [info ] [Thread-1 (]: 1 of 6 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m15:27:44.757315 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:27:44.757315 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m15:27:44.758317 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m15:27:44.762316 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m15:27:44.763317 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:44.763317 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m15:27:44.810351 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m15:27:44.811349 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:27:44.811349 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m15:27:44.812317 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:27:44.865316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:27:44.866316 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:27:44.866316 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_prs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m15:27:44.871316 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:27:44.886822 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m15:27:44.887821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:27:44.887821 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m15:27:44.888821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:27:44.889822 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:44.889822 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m15:27:44.890821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FD1AA40>]}
[0m15:27:44.891822 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model abu.d_customer_incremental_prs ......... [[32mSELECT 2[0m in 0.13s]
[0m15:27:44.893823 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m15:27:44.893823 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_trs
[0m15:27:44.894822 [info ] [Thread-1 (]: 2 of 6 START sql incremental model abu.d_customer_incremental_trs .............. [RUN]
[0m15:27:44.895822 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:27:44.895822 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_trs
[0m15:27:44.895822 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_trs
[0m15:27:44.898821 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_trs"
[0m15:27:44.899822 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:44.900822 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_trs
[0m15:27:44.904822 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_trs"
[0m15:27:44.905822 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:27:44.906822 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: BEGIN
[0m15:27:44.906822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:44.960822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:27:44.960822 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:27:44.960822 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_trs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m15:27:44.965822 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:27:44.967822 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m15:27:44.967822 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:27:44.967822 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m15:27:44.969821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:27:44.969821 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:44.969821 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: Close
[0m15:27:44.970822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FBBB8B0>]}
[0m15:27:44.971822 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model abu.d_customer_incremental_trs ......... [[32mSELECT 2[0m in 0.08s]
[0m15:27:44.972822 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_trs
[0m15:27:44.973822 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m15:27:44.973822 [info ] [Thread-1 (]: 3 of 6 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m15:27:44.974822 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m15:27:44.974822 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m15:27:44.975822 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m15:27:44.977821 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m15:27:44.978821 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:44.978821 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m15:27:44.992821 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m15:27:44.993822 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:27:44.993822 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m15:27:44.993822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:45.046822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:27:45.047866 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:27:45.047866 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m15:27:45.052822 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:27:45.057823 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:27:45.058821 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs__dbt_tmp" rename to "d_customer_table_prs"
[0m15:27:45.058821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:27:45.060822 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m15:27:45.061821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:27:45.061821 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m15:27:45.062822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:27:45.066821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:27:45.066821 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
drop table if exists "postgres"."abu"."d_customer_table_prs__dbt_backup" cascade
[0m15:27:45.067821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:27:45.068823 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:45.068823 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m15:27:45.069822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209098A4970>]}
[0m15:27:45.070823 [info ] [Thread-1 (]: 3 of 6 OK created sql table model abu.d_customer_table_prs ..................... [[32mSELECT 2[0m in 0.09s]
[0m15:27:45.071823 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m15:27:45.072832 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_trs
[0m15:27:45.072832 [info ] [Thread-1 (]: 4 of 6 START sql table model abu.d_customer_table_trs .......................... [RUN]
[0m15:27:45.073832 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_trs"
[0m15:27:45.074826 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_trs
[0m15:27:45.074826 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_trs
[0m15:27:45.076824 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_trs"
[0m15:27:45.077824 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:45.078823 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_trs
[0m15:27:45.082825 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_trs"
[0m15:27:45.083823 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:27:45.083823 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: BEGIN
[0m15:27:45.084837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:45.137822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:27:45.138823 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:27:45.138823 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_trs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m15:27:45.143822 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:27:45.146821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:27:45.146821 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs__dbt_tmp" rename to "d_customer_table_trs"
[0m15:27:45.147822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:27:45.149826 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m15:27:45.150825 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:27:45.150825 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m15:27:45.151824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:27:45.153822 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:27:45.154838 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
drop table if exists "postgres"."abu"."d_customer_table_trs__dbt_backup" cascade
[0m15:27:45.155822 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:27:45.156823 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:45.156823 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: Close
[0m15:27:45.157821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CFED720>]}
[0m15:27:45.157821 [info ] [Thread-1 (]: 4 of 6 OK created sql table model abu.d_customer_table_trs ..................... [[32mSELECT 2[0m in 0.08s]
[0m15:27:45.159825 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_trs
[0m15:27:45.160823 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m15:27:45.160823 [info ] [Thread-1 (]: 5 of 6 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m15:27:45.161835 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m15:27:45.161835 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m15:27:45.162827 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m15:27:45.165825 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m15:27:45.166825 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:45.166825 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m15:27:45.186826 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m15:27:45.187826 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:27:45.188826 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m15:27:45.188826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:45.243821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:27:45.243821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:27:45.244821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m15:27:45.248821 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:27:45.251821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:27:45.251821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs__dbt_tmp" rename to "d_customer_view_prs"
[0m15:27:45.252821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:27:45.253821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m15:27:45.254834 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:27:45.254834 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m15:27:45.255822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:27:45.257821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:27:45.258821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
drop view if exists "postgres"."abu"."d_customer_view_prs__dbt_backup" cascade
[0m15:27:45.258821 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:27:45.259821 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:45.259821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m15:27:45.260821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FEDFC70>]}
[0m15:27:45.261821 [info ] [Thread-1 (]: 5 of 6 OK created sql view model abu.d_customer_view_prs ....................... [[32mCREATE VIEW[0m in 0.10s]
[0m15:27:45.262821 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m15:27:45.263823 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_trs
[0m15:27:45.263823 [info ] [Thread-1 (]: 6 of 6 START sql view model abu.d_customer_view_trs ............................ [RUN]
[0m15:27:45.264822 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_trs"
[0m15:27:45.265821 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_trs
[0m15:27:45.265821 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_trs
[0m15:27:45.267821 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_trs"
[0m15:27:45.269821 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:45.269821 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_trs
[0m15:27:45.273821 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_trs"
[0m15:27:45.274821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:27:45.274821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: BEGIN
[0m15:27:45.274821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:45.329822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m15:27:45.329822 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:27:45.329822 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */

  create view "postgres"."abu"."d_customer_view_trs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m15:27:45.335822 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:27:45.337821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:27:45.337821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs__dbt_tmp" rename to "d_customer_view_trs"
[0m15:27:45.338821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:27:45.339822 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m15:27:45.340821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:27:45.340821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m15:27:45.341822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:27:45.343821 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:27:45.343821 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
drop view if exists "postgres"."abu"."d_customer_view_trs__dbt_backup" cascade
[0m15:27:45.344822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:27:45.345822 [debug] [Thread-1 (]: finished collecting timing info
[0m15:27:45.345822 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: Close
[0m15:27:45.345822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c544fbe-d655-4b8e-8c18-ca1c28388778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FBE8400>]}
[0m15:27:45.346822 [info ] [Thread-1 (]: 6 of 6 OK created sql view model abu.d_customer_view_trs ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:27:45.348823 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_trs
[0m15:27:45.349838 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:27:45.350822 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:45.350822 [debug] [MainThread]: On master: BEGIN
[0m15:27:45.350822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:45.401822 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:27:45.402822 [debug] [MainThread]: On master: COMMIT
[0m15:27:45.402822 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:45.402822 [debug] [MainThread]: On master: COMMIT
[0m15:27:45.403821 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:27:45.403821 [debug] [MainThread]: On master: Close
[0m15:27:45.404831 [info ] [MainThread]: 
[0m15:27:45.405822 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m15:27:45.407821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:45.407821 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:27:45.408821 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m15:27:45.408821 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_trs' was properly closed.
[0m15:27:45.415822 [info ] [MainThread]: 
[0m15:27:45.415822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:27:45.416821 [info ] [MainThread]: 
[0m15:27:45.417821 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:27:45.418822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FEDFC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FE4EF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090FE4D420>]}
[0m15:27:45.418822 [debug] [MainThread]: Flushing usage events
[0m15:27:45.561822 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 15:28:44.441025 | 05eea749-b4da-4724-8b14-4630da0ea0f6 ==============================
[0m15:28:44.441025 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:28:44.442025 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m15:28:44.442025 [debug] [MainThread]: Tracking: tracking
[0m15:28:44.462025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3ABF7DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3ABF51B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3ABF7A90>]}
[0m15:28:44.554533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:44.554533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:44.555533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m15:28:44.560533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05eea749-b4da-4724-8b14-4630da0ea0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3AEAA9B0>]}
[0m15:28:44.567541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05eea749-b4da-4724-8b14-4630da0ea0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E380F7A00>]}
[0m15:28:44.568533 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m15:28:44.568533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05eea749-b4da-4724-8b14-4630da0ea0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3736E560>]}
[0m15:28:44.569533 [info ] [MainThread]: 
[0m15:28:44.570534 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:28:44.572534 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:28:44.581533 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:28:44.582535 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:28:44.582535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:44.642533 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m15:28:44.643533 [debug] [ThreadPool]: On list_postgres: Close
[0m15:28:44.645533 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m15:28:44.650532 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:28:44.650532 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m15:28:44.651532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:44.702533 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m15:28:44.702533 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:28:44.702533 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m15:28:44.709533 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m15:28:44.710534 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m15:28:44.711532 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m15:28:44.716532 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:44.716532 [debug] [MainThread]: On master: BEGIN
[0m15:28:44.716532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:44.766533 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:28:44.767533 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:44.767533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:44.814534 [debug] [MainThread]: SQL status: SELECT 2 in 0.05 seconds
[0m15:28:44.816533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05eea749-b4da-4724-8b14-4630da0ea0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3ABF7DF0>]}
[0m15:28:44.816533 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:44.817534 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:44.817534 [debug] [MainThread]: On master: BEGIN
[0m15:28:44.818534 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:28:44.818534 [debug] [MainThread]: On master: COMMIT
[0m15:28:44.818534 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:44.819534 [debug] [MainThread]: On master: COMMIT
[0m15:28:44.819534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:44.819534 [debug] [MainThread]: On master: Close
[0m15:28:44.820533 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m15:28:44.821534 [info ] [MainThread]: 
[0m15:28:44.832534 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_prs_snapshot
[0m15:28:44.833534 [info ] [Thread-1 (]: 1 of 2 START snapshot abu.customer_prs_snapshot ................................ [RUN]
[0m15:28:44.834533 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:28:44.834533 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_prs_snapshot
[0m15:28:44.835533 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_prs_snapshot
[0m15:28:44.837533 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:44.838533 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_prs_snapshot
[0m15:28:44.880532 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_prs_snapshot"
[0m15:28:44.882533 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:28:44.882533 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: BEGIN
[0m15:28:44.882533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:44.936533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:28:44.936533 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:28:44.936533 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_prs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with country as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m15:28:44.937570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»w_custÂ« existiert nicht
LINE 30: from w_cust c
              ^

[0m15:28:44.938564 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: ROLLBACK
[0m15:28:44.938564 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:44.939565 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: Close
[0m15:28:44.940534 [debug] [Thread-1 (]: Database Error in snapshot customer_prs_snapshot (snapshots\d_customer_snapshot_prs.sql)
  FEHLER:  Relation Â»w_custÂ« existiert nicht
  LINE 30: from w_cust c
                ^
  compiled Code at target\run\scenarios\snapshots\d_customer_snapshot_prs.sql
[0m15:28:44.940534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05eea749-b4da-4724-8b14-4630da0ea0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3AEFBDF0>]}
[0m15:28:44.941535 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting abu.customer_prs_snapshot ............................ [[31mERROR[0m in 0.11s]
[0m15:28:44.942533 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_prs_snapshot
[0m15:28:44.943533 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_trs_snapshot
[0m15:28:44.943533 [info ] [Thread-1 (]: 2 of 2 START snapshot abu.customer_trs_snapshot ................................ [RUN]
[0m15:28:44.944533 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:28:44.944533 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_trs_snapshot
[0m15:28:44.944533 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_trs_snapshot
[0m15:28:44.947533 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:44.948533 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_trs_snapshot
[0m15:28:44.951532 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_trs_snapshot"
[0m15:28:44.952534 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:28:44.952534 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: BEGIN
[0m15:28:44.952534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:45.005534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:28:45.005534 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:28:45.005534 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_trs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with country as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m15:28:45.006533 [debug] [Thread-1 (]: Postgres adapter: Postgres error: FEHLER:  Relation Â»w_custÂ« existiert nicht
LINE 30: from w_cust c
              ^

[0m15:28:45.007542 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: ROLLBACK
[0m15:28:45.007542 [debug] [Thread-1 (]: finished collecting timing info
[0m15:28:45.007542 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: Close
[0m15:28:45.008532 [debug] [Thread-1 (]: Database Error in snapshot customer_trs_snapshot (snapshots\d_customer_snapshot_trs.sql)
  FEHLER:  Relation Â»w_custÂ« existiert nicht
  LINE 30: from w_cust c
                ^
  compiled Code at target\run\scenarios\snapshots\d_customer_snapshot_trs.sql
[0m15:28:45.009533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05eea749-b4da-4724-8b14-4630da0ea0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3AEFB3D0>]}
[0m15:28:45.009533 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting abu.customer_trs_snapshot ............................ [[31mERROR[0m in 0.07s]
[0m15:28:45.011538 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_trs_snapshot
[0m15:28:45.012533 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:28:45.013553 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:45.013553 [debug] [MainThread]: On master: BEGIN
[0m15:28:45.013553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:45.067533 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:28:45.067533 [debug] [MainThread]: On master: COMMIT
[0m15:28:45.068534 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:45.068534 [debug] [MainThread]: On master: COMMIT
[0m15:28:45.068534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:45.069533 [debug] [MainThread]: On master: Close
[0m15:28:45.070533 [info ] [MainThread]: 
[0m15:28:45.070533 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:28:45.079532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:45.080538 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:28:45.080538 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m15:28:45.080538 [debug] [MainThread]: Connection 'snapshot.scenarios.customer_trs_snapshot' was properly closed.
[0m15:28:45.086544 [info ] [MainThread]: 
[0m15:28:45.087533 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:28:45.088534 [info ] [MainThread]: 
[0m15:28:45.089533 [error] [MainThread]: [33mDatabase Error in snapshot customer_prs_snapshot (snapshots\d_customer_snapshot_prs.sql)[0m
[0m15:28:45.089533 [error] [MainThread]:   FEHLER:  Relation Â»w_custÂ« existiert nicht
[0m15:28:45.090535 [error] [MainThread]:   LINE 30: from w_cust c
[0m15:28:45.091533 [error] [MainThread]:                 ^
[0m15:28:45.091533 [error] [MainThread]:   compiled Code at target\run\scenarios\snapshots\d_customer_snapshot_prs.sql
[0m15:28:45.092544 [info ] [MainThread]: 
[0m15:28:45.092544 [error] [MainThread]: [33mDatabase Error in snapshot customer_trs_snapshot (snapshots\d_customer_snapshot_trs.sql)[0m
[0m15:28:45.093533 [error] [MainThread]:   FEHLER:  Relation Â»w_custÂ« existiert nicht
[0m15:28:45.093533 [error] [MainThread]:   LINE 30: from w_cust c
[0m15:28:45.094533 [error] [MainThread]:                 ^
[0m15:28:45.094533 [error] [MainThread]:   compiled Code at target\run\scenarios\snapshots\d_customer_snapshot_trs.sql
[0m15:28:45.095533 [info ] [MainThread]: 
[0m15:28:45.095533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:28:45.096533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3ABF5A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3ACE9C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E3AF81810>]}
[0m15:28:45.096533 [debug] [MainThread]: Flushing usage events
[0m15:28:45.223729 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 15:31:46.163448 | 574c2801-c8ba-4557-9e00-ec91ed31d81b ==============================
[0m15:31:46.163448 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:31:46.163448 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m15:31:46.164481 [debug] [MainThread]: Tracking: tracking
[0m15:31:46.183450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D4DBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D4DA1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D4D8D90>]}
[0m15:31:46.271447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:31:46.272447 [debug] [MainThread]: Partial parsing: updated file: scenarios://snapshots\d_customer_snapshot_prs.sql
[0m15:31:46.272447 [debug] [MainThread]: Partial parsing: updated file: scenarios://snapshots\d_customer_snapshot_trs.sql
[0m15:31:46.310450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m15:31:46.316449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '574c2801-c8ba-4557-9e00-ec91ed31d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D7782B0>]}
[0m15:31:46.323449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '574c2801-c8ba-4557-9e00-ec91ed31d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D731C30>]}
[0m15:31:46.324448 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m15:31:46.324448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '574c2801-c8ba-4557-9e00-ec91ed31d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D99BEE4D0>]}
[0m15:31:46.325450 [info ] [MainThread]: 
[0m15:31:46.326450 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:31:46.328448 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:31:46.337448 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:31:46.338449 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:31:46.338449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:46.399447 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m15:31:46.400448 [debug] [ThreadPool]: On list_postgres: Close
[0m15:31:46.403448 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m15:31:46.408448 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:31:46.409448 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m15:31:46.410449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:46.463483 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m15:31:46.463483 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:31:46.464502 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m15:31:46.471480 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m15:31:46.472487 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m15:31:46.473450 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m15:31:46.477449 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:46.477449 [debug] [MainThread]: On master: BEGIN
[0m15:31:46.478448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:46.531449 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:31:46.531449 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:46.531449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:46.574478 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m15:31:46.575449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '574c2801-c8ba-4557-9e00-ec91ed31d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D5D02E0>]}
[0m15:31:46.576449 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:46.576449 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:46.577449 [debug] [MainThread]: On master: BEGIN
[0m15:31:46.577449 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:46.577449 [debug] [MainThread]: On master: COMMIT
[0m15:31:46.578449 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:46.578449 [debug] [MainThread]: On master: COMMIT
[0m15:31:46.578449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:46.579449 [debug] [MainThread]: On master: Close
[0m15:31:46.579449 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m15:31:46.580449 [info ] [MainThread]: 
[0m15:31:46.591450 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_prs_snapshot
[0m15:31:46.592449 [info ] [Thread-1 (]: 1 of 2 START snapshot abu.customer_prs_snapshot ................................ [RUN]
[0m15:31:46.593450 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:31:46.593450 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_prs_snapshot
[0m15:31:46.593450 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_prs_snapshot
[0m15:31:46.597488 [debug] [Thread-1 (]: finished collecting timing info
[0m15:31:46.597488 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_prs_snapshot
[0m15:31:46.637482 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_prs_snapshot"
[0m15:31:46.638488 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:31:46.638488 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: BEGIN
[0m15:31:46.638488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:46.692450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:31:46.693450 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:31:46.693450 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_prs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m15:31:46.713456 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.02 seconds
[0m15:31:46.730450 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m15:31:46.730450 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:31:46.731449 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m15:31:46.732450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:46.733493 [debug] [Thread-1 (]: finished collecting timing info
[0m15:31:46.733493 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: Close
[0m15:31:46.734449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '574c2801-c8ba-4557-9e00-ec91ed31d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D7612A0>]}
[0m15:31:46.734449 [info ] [Thread-1 (]: 1 of 2 OK snapshotted abu.customer_prs_snapshot ................................ [[32mSELECT 2[0m in 0.14s]
[0m15:31:46.736448 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_prs_snapshot
[0m15:31:46.737470 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_trs_snapshot
[0m15:31:46.737470 [info ] [Thread-1 (]: 2 of 2 START snapshot abu.customer_trs_snapshot ................................ [RUN]
[0m15:31:46.738448 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:31:46.739450 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_trs_snapshot
[0m15:31:46.739450 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_trs_snapshot
[0m15:31:46.742488 [debug] [Thread-1 (]: finished collecting timing info
[0m15:31:46.742488 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_trs_snapshot
[0m15:31:46.745448 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_trs_snapshot"
[0m15:31:46.746448 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:31:46.747448 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: BEGIN
[0m15:31:46.747448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:46.800489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:31:46.801449 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:31:46.801449 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_trs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m15:31:46.811482 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m15:31:46.813449 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m15:31:46.814449 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:31:46.814449 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m15:31:46.815482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:46.816449 [debug] [Thread-1 (]: finished collecting timing info
[0m15:31:46.816449 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: Close
[0m15:31:46.817449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '574c2801-c8ba-4557-9e00-ec91ed31d81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D7CA2C0>]}
[0m15:31:46.817449 [info ] [Thread-1 (]: 2 of 2 OK snapshotted abu.customer_trs_snapshot ................................ [[32mSELECT 2[0m in 0.08s]
[0m15:31:46.819448 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_trs_snapshot
[0m15:31:46.820456 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:31:46.821486 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:46.821486 [debug] [MainThread]: On master: BEGIN
[0m15:31:46.821486 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:46.874482 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:31:46.874482 [debug] [MainThread]: On master: COMMIT
[0m15:31:46.874482 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:46.875449 [debug] [MainThread]: On master: COMMIT
[0m15:31:46.875449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:46.875449 [debug] [MainThread]: On master: Close
[0m15:31:46.876449 [info ] [MainThread]: 
[0m15:31:46.877449 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m15:31:46.879449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:46.879449 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:31:46.879449 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m15:31:46.880449 [debug] [MainThread]: Connection 'snapshot.scenarios.customer_trs_snapshot' was properly closed.
[0m15:31:46.887470 [info ] [MainThread]: 
[0m15:31:46.888448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:46.889450 [info ] [MainThread]: 
[0m15:31:46.889450 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:31:46.890450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D747EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9A9B6E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D9D8931F0>]}
[0m15:31:46.890450 [debug] [MainThread]: Flushing usage events
[0m15:31:47.020992 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 15:57:05.161573 | 293fa8a4-986d-428e-984a-c757a80a2eb3 ==============================
[0m15:57:05.161573 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:57:05.162572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:57:05.162572 [debug] [MainThread]: Tracking: tracking
[0m15:57:05.182572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F497D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F4961A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F494D60>]}
[0m15:57:05.276572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:05.276572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:05.277572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m15:57:05.283572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F73A950>]}
[0m15:57:05.290586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F589DB0>]}
[0m15:57:05.290586 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m15:57:05.291573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F714250>]}
[0m15:57:05.292573 [info ] [MainThread]: 
[0m15:57:05.299572 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:57:05.302572 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:57:05.311571 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:57:05.311571 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:57:05.312591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:05.378572 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.07 seconds
[0m15:57:05.380583 [debug] [ThreadPool]: On list_postgres: Close
[0m15:57:05.382572 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m15:57:05.387571 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:57:05.387571 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m15:57:05.387571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:05.436087 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m15:57:05.436087 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:57:05.437091 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m15:57:05.443087 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m15:57:05.444087 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m15:57:05.444087 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m15:57:05.449087 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.450087 [debug] [MainThread]: On master: BEGIN
[0m15:57:05.450087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:05.502087 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:57:05.503118 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.503118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:05.540086 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m15:57:05.541139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F6FFAF0>]}
[0m15:57:05.542118 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:05.542118 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.542118 [debug] [MainThread]: On master: BEGIN
[0m15:57:05.543122 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:57:05.544088 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.544088 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:05.544088 [debug] [MainThread]: On master: COMMIT
[0m15:57:05.545087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:57:05.545087 [debug] [MainThread]: On master: Close
[0m15:57:05.546087 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m15:57:05.546087 [info ] [MainThread]: 
[0m15:57:05.558087 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m15:57:05.558087 [info ] [Thread-1 (]: 1 of 6 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m15:57:05.560089 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:57:05.561087 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m15:57:05.561087 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m15:57:05.567087 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m15:57:05.569089 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.569089 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m15:57:05.615117 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m15:57:05.616124 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:57:05.617088 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m15:57:05.617088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:05.668087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:57:05.669088 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:57:05.669088 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_prs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m15:57:05.675087 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.01 seconds
[0m15:57:05.696126 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m15:57:05.697134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m15:57:05.697134 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m15:57:05.699088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:05.699088 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.700124 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m15:57:05.700124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F786E60>]}
[0m15:57:05.701088 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model abu.d_customer_incremental_prs ......... [[32mSELECT 4[0m in 0.14s]
[0m15:57:05.703189 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m15:57:05.703189 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_trs
[0m15:57:05.703189 [info ] [Thread-1 (]: 2 of 6 START sql incremental model abu.d_customer_incremental_trs .............. [RUN]
[0m15:57:05.704187 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:57:05.705186 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_trs
[0m15:57:05.705186 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_trs
[0m15:57:05.708184 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_trs"
[0m15:57:05.709185 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.710185 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_trs
[0m15:57:05.714186 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_trs"
[0m15:57:05.716196 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:57:05.716196 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: BEGIN
[0m15:57:05.716196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.768186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:57:05.768186 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:57:05.768186 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_trs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m15:57:05.773185 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:57:05.775185 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m15:57:05.775185 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m15:57:05.775185 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m15:57:05.776185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:05.777187 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.777187 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: Close
[0m15:57:05.778185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F7879A0>]}
[0m15:57:05.778185 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model abu.d_customer_incremental_trs ......... [[32mSELECT 2[0m in 0.07s]
[0m15:57:05.780185 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_trs
[0m15:57:05.781199 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m15:57:05.781199 [info ] [Thread-1 (]: 3 of 6 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m15:57:05.782185 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m15:57:05.783185 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m15:57:05.783185 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m15:57:05.785184 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m15:57:05.786184 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.787188 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m15:57:05.799184 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m15:57:05.800185 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:57:05.801185 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m15:57:05.801185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.853185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:57:05.854186 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:57:05.854186 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m15:57:05.859185 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m15:57:05.865185 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:57:05.865185 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs__dbt_tmp" rename to "d_customer_table_prs"
[0m15:57:05.866185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:57:05.868184 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m15:57:05.868184 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:57:05.868184 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m15:57:05.869184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:05.873184 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m15:57:05.874184 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
drop table if exists "postgres"."abu"."d_customer_table_prs__dbt_backup" cascade
[0m15:57:05.874184 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:57:05.875185 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.875185 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m15:57:05.877185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F6FF250>]}
[0m15:57:05.877185 [info ] [Thread-1 (]: 3 of 6 OK created sql table model abu.d_customer_table_prs ..................... [[32mSELECT 4[0m in 0.09s]
[0m15:57:05.879187 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m15:57:05.879187 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_trs
[0m15:57:05.880185 [info ] [Thread-1 (]: 4 of 6 START sql table model abu.d_customer_table_trs .......................... [RUN]
[0m15:57:05.881186 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_trs"
[0m15:57:05.881186 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_trs
[0m15:57:05.882186 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_trs
[0m15:57:05.884186 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_trs"
[0m15:57:05.885191 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.886194 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_trs
[0m15:57:05.890186 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_trs"
[0m15:57:05.891186 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:57:05.892188 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: BEGIN
[0m15:57:05.892188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:05.951858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m15:57:05.952856 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:57:05.952856 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_trs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m15:57:05.959868 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m15:57:05.962852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:57:05.962852 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs__dbt_tmp" rename to "d_customer_table_trs"
[0m15:57:05.963853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:57:05.966852 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m15:57:05.966852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:57:05.967852 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m15:57:05.968852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:05.970853 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m15:57:05.971852 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
drop table if exists "postgres"."abu"."d_customer_table_trs__dbt_backup" cascade
[0m15:57:05.971852 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:57:05.972853 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.973851 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: Close
[0m15:57:05.973851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F784880>]}
[0m15:57:05.974853 [info ] [Thread-1 (]: 4 of 6 OK created sql table model abu.d_customer_table_trs ..................... [[32mSELECT 2[0m in 0.09s]
[0m15:57:05.975873 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_trs
[0m15:57:05.976853 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m15:57:05.976853 [info ] [Thread-1 (]: 5 of 6 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m15:57:05.977852 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m15:57:05.978859 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m15:57:05.978859 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m15:57:05.981851 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m15:57:05.982852 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:05.982852 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m15:57:05.999852 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m15:57:06.000853 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:57:06.001856 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m15:57:06.001856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:06.052854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:57:06.053853 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:57:06.053853 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m15:57:06.057854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:57:06.060854 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:57:06.060854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs__dbt_tmp" rename to "d_customer_view_prs"
[0m15:57:06.060854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:57:06.062855 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m15:57:06.062855 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:57:06.063853 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m15:57:06.064854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:06.065854 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m15:57:06.066854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
drop view if exists "postgres"."abu"."d_customer_view_prs__dbt_backup" cascade
[0m15:57:06.066854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:57:06.067854 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:06.067854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m15:57:06.068853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F87BE50>]}
[0m15:57:06.069854 [info ] [Thread-1 (]: 5 of 6 OK created sql view model abu.d_customer_view_prs ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:57:06.070854 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m15:57:06.071879 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_trs
[0m15:57:06.071879 [info ] [Thread-1 (]: 6 of 6 START sql view model abu.d_customer_view_trs ............................ [RUN]
[0m15:57:06.072854 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_trs"
[0m15:57:06.072854 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_trs
[0m15:57:06.072854 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_trs
[0m15:57:06.075854 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_trs"
[0m15:57:06.076853 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:06.076853 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_trs
[0m15:57:06.081857 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_trs"
[0m15:57:06.082855 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:57:06.082855 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: BEGIN
[0m15:57:06.083854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:06.136854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:57:06.137854 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:57:06.137854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */

  create view "postgres"."abu"."d_customer_view_trs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m15:57:06.142854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m15:57:06.144854 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:57:06.145852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs__dbt_tmp" rename to "d_customer_view_trs"
[0m15:57:06.146852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:57:06.148854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m15:57:06.148854 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:57:06.148854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m15:57:06.149854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:06.151854 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m15:57:06.151854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
drop view if exists "postgres"."abu"."d_customer_view_trs__dbt_backup" cascade
[0m15:57:06.152854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:57:06.153854 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:06.153854 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: Close
[0m15:57:06.154854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293fa8a4-986d-428e-984a-c757a80a2eb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F760280>]}
[0m15:57:06.154854 [info ] [Thread-1 (]: 6 of 6 OK created sql view model abu.d_customer_view_trs ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:57:06.156872 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_trs
[0m15:57:06.157852 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:57:06.158854 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:06.158854 [debug] [MainThread]: On master: BEGIN
[0m15:57:06.158854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:06.209854 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:57:06.210854 [debug] [MainThread]: On master: COMMIT
[0m15:57:06.210854 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:06.210854 [debug] [MainThread]: On master: COMMIT
[0m15:57:06.211854 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:57:06.211854 [debug] [MainThread]: On master: Close
[0m15:57:06.212854 [info ] [MainThread]: 
[0m15:57:06.212854 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m15:57:06.214860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:06.215856 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:57:06.215856 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m15:57:06.215856 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_trs' was properly closed.
[0m15:57:06.222856 [info ] [MainThread]: 
[0m15:57:06.224856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:06.225856 [info ] [MainThread]: 
[0m15:57:06.234855 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:57:06.235855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F770910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F6FFC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7F883FD0>]}
[0m15:57:06.235855 [debug] [MainThread]: Flushing usage events
[0m15:57:06.398434 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 15:57:13.457872 | 967c924d-8c20-4ec4-9166-0a5314ed3d16 ==============================
[0m15:57:13.457872 [info ] [MainThread]: Running with dbt=1.3.0
[0m15:57:13.457872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m15:57:13.458872 [debug] [MainThread]: Tracking: tracking
[0m15:57:13.478873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B90BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B90A1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B908D60>]}
[0m15:57:13.566872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:13.567872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:13.567872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m15:57:13.574872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '967c924d-8c20-4ec4-9166-0a5314ed3d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BBBE950>]}
[0m15:57:13.580872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967c924d-8c20-4ec4-9166-0a5314ed3d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B9F9DB0>]}
[0m15:57:13.581872 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m15:57:13.582872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967c924d-8c20-4ec4-9166-0a5314ed3d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BB98250>]}
[0m15:57:13.583872 [info ] [MainThread]: 
[0m15:57:13.584872 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:57:13.586871 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m15:57:13.595871 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:57:13.595871 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:57:13.595871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:13.655871 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m15:57:13.656872 [debug] [ThreadPool]: On list_postgres: Close
[0m15:57:13.658872 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m15:57:13.663870 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:57:13.664884 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m15:57:13.664884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:13.715872 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m15:57:13.715872 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m15:57:13.716893 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m15:57:13.722872 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m15:57:13.723872 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m15:57:13.724872 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m15:57:13.730871 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:13.730871 [debug] [MainThread]: On master: BEGIN
[0m15:57:13.731881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:13.784874 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:57:13.784874 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:13.784874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:13.826900 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m15:57:13.828873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967c924d-8c20-4ec4-9166-0a5314ed3d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B90BD60>]}
[0m15:57:13.828873 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:13.829872 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:13.829872 [debug] [MainThread]: On master: BEGIN
[0m15:57:13.829872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:57:13.830872 [debug] [MainThread]: On master: COMMIT
[0m15:57:13.830872 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:13.830872 [debug] [MainThread]: On master: COMMIT
[0m15:57:13.831878 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:57:13.831878 [debug] [MainThread]: On master: Close
[0m15:57:13.832872 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m15:57:13.832872 [info ] [MainThread]: 
[0m15:57:13.844872 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_prs_snapshot
[0m15:57:13.844872 [info ] [Thread-1 (]: 1 of 2 START snapshot abu.customer_prs_snapshot ................................ [RUN]
[0m15:57:13.845872 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:57:13.845872 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_prs_snapshot
[0m15:57:13.846872 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_prs_snapshot
[0m15:57:13.849877 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:13.849877 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_prs_snapshot
[0m15:57:13.895905 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_prs_snapshot"
[0m15:57:13.896900 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:57:13.897872 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: BEGIN
[0m15:57:13.897872 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:13.948872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:57:13.948872 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:57:13.949905 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_prs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m15:57:13.969872 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.02 seconds
[0m15:57:13.985904 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m15:57:13.986906 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m15:57:13.986906 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m15:57:13.987872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:13.988873 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:13.988873 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: Close
[0m15:57:13.989908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967c924d-8c20-4ec4-9166-0a5314ed3d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BA01240>]}
[0m15:57:13.989908 [info ] [Thread-1 (]: 1 of 2 OK snapshotted abu.customer_prs_snapshot ................................ [[32mSELECT 4[0m in 0.14s]
[0m15:57:13.991888 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_prs_snapshot
[0m15:57:13.992874 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_trs_snapshot
[0m15:57:13.992874 [info ] [Thread-1 (]: 2 of 2 START snapshot abu.customer_trs_snapshot ................................ [RUN]
[0m15:57:13.993873 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:57:13.993873 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_trs_snapshot
[0m15:57:13.994871 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_trs_snapshot
[0m15:57:13.997905 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:13.997905 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_trs_snapshot
[0m15:57:14.000901 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_trs_snapshot"
[0m15:57:14.001901 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:57:14.002899 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: BEGIN
[0m15:57:14.002899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:14.054872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m15:57:14.055902 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:57:14.055902 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_trs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m15:57:14.066872 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m15:57:14.068872 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m15:57:14.069871 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m15:57:14.069871 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m15:57:14.070871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:57:14.071872 [debug] [Thread-1 (]: finished collecting timing info
[0m15:57:14.071872 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: Close
[0m15:57:14.072872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967c924d-8c20-4ec4-9166-0a5314ed3d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BC081C0>]}
[0m15:57:14.072872 [info ] [Thread-1 (]: 2 of 2 OK snapshotted abu.customer_trs_snapshot ................................ [[32mSELECT 2[0m in 0.08s]
[0m15:57:14.074899 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_trs_snapshot
[0m15:57:14.076873 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m15:57:14.076873 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:14.077872 [debug] [MainThread]: On master: BEGIN
[0m15:57:14.077872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:14.130872 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m15:57:14.131880 [debug] [MainThread]: On master: COMMIT
[0m15:57:14.131880 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:14.131880 [debug] [MainThread]: On master: COMMIT
[0m15:57:14.132908 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:57:14.132908 [debug] [MainThread]: On master: Close
[0m15:57:14.133872 [info ] [MainThread]: 
[0m15:57:14.134892 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m15:57:14.136873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:14.136873 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m15:57:14.136873 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m15:57:14.137872 [debug] [MainThread]: Connection 'snapshot.scenarios.customer_trs_snapshot' was properly closed.
[0m15:57:14.144877 [info ] [MainThread]: 
[0m15:57:14.145872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:14.146872 [info ] [MainThread]: 
[0m15:57:14.147872 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:57:14.147872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BC14730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BC14B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BC15300>]}
[0m15:57:14.148875 [debug] [MainThread]: Flushing usage events
[0m15:57:14.517823 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:18:53.062770 | c7d6ee94-15da-4894-8927-1030e34ab1c2 ==============================
[0m16:18:53.062770 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:18:53.063780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:18:53.063780 [debug] [MainThread]: Tracking: tracking
[0m16:18:53.081771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198456CB8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198456C8EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198456CBC40>]}
[0m16:18:53.171770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:18:53.172770 [debug] [MainThread]: Partial parsing: updated file: scenarios://models\mart\d_customer_incremental_trs.sql
[0m16:18:53.182784 [debug] [MainThread]: 1603: static parser failed on mart\d_customer_incremental_trs.sql
[0m16:18:53.195803 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mart\d_customer_incremental_trs.sql
[0m16:18:53.208770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:18:53.213769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984598B9A0>]}
[0m16:18:53.221774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198457BBB20>]}
[0m16:18:53.221774 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:18:53.222771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198459216F0>]}
[0m16:18:53.223771 [info ] [MainThread]: 
[0m16:18:53.228771 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:18:53.230771 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:18:53.245771 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:18:53.245771 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:18:53.246803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:53.308770 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m16:18:53.310770 [debug] [ThreadPool]: On list_postgres: Close
[0m16:18:53.312782 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:18:53.317771 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:18:53.318772 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:18:53.318772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:53.372771 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:18:53.372771 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:18:53.372771 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:18:53.378772 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m16:18:53.380772 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:18:53.380772 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:18:53.385804 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:53.385804 [debug] [MainThread]: On master: BEGIN
[0m16:18:53.385804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:53.437771 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:18:53.437771 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:53.438771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:18:53.476800 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m16:18:53.477772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984593B640>]}
[0m16:18:53.477772 [debug] [MainThread]: On master: ROLLBACK
[0m16:18:53.478770 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:53.478770 [debug] [MainThread]: On master: BEGIN
[0m16:18:53.479771 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:18:53.479771 [debug] [MainThread]: On master: COMMIT
[0m16:18:53.479771 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:53.479771 [debug] [MainThread]: On master: COMMIT
[0m16:18:53.480770 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:18:53.480770 [debug] [MainThread]: On master: Close
[0m16:18:53.481770 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:18:53.482771 [info ] [MainThread]: 
[0m16:18:53.493773 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m16:18:53.493773 [info ] [Thread-1 (]: 1 of 6 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m16:18:53.494772 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:18:53.494772 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m16:18:53.495771 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m16:18:53.498771 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m16:18:53.499771 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.499771 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m16:18:53.547804 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m16:18:53.548807 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:18:53.548807 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m16:18:53.549787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:18:53.603771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:18:53.604771 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:18:53.604771 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_prs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:18:53.610771 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:18:53.629771 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:18:53.630772 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:18:53.630772 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:18:53.632781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:18:53.633777 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.634776 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m16:18:53.635779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198456CB8E0>]}
[0m16:18:53.636772 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model abu.d_customer_incremental_prs ......... [[32mSELECT 2[0m in 0.14s]
[0m16:18:53.638774 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m16:18:53.638774 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_trs
[0m16:18:53.639773 [info ] [Thread-1 (]: 2 of 6 START sql incremental model abu.d_customer_incremental_trs .............. [RUN]
[0m16:18:53.640788 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:18:53.640788 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_trs
[0m16:18:53.640788 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_trs
[0m16:18:53.644774 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_trs"
[0m16:18:53.645775 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.645775 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_trs
[0m16:18:53.652772 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_trs"
[0m16:18:53.654775 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:18:53.654775 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: BEGIN
[0m16:18:53.655772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:53.707771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:18:53.707771 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:18:53.708771 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_trs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:18:53.713771 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:18:53.715771 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:18:53.716773 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:18:53.716773 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:18:53.717770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:18:53.718771 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.718771 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: Close
[0m16:18:53.719771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019845A00910>]}
[0m16:18:53.719771 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model abu.d_customer_incremental_trs ......... [[32mSELECT 2[0m in 0.08s]
[0m16:18:53.721772 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_trs
[0m16:18:53.721772 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m16:18:53.722771 [info ] [Thread-1 (]: 3 of 6 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m16:18:53.723790 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m16:18:53.723790 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m16:18:53.723790 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m16:18:53.726770 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m16:18:53.727771 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.727771 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m16:18:53.738782 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m16:18:53.740770 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:18:53.740770 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m16:18:53.740770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:53.794770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:18:53.794770 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:18:53.794770 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:18:53.799790 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:18:53.805770 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:18:53.806770 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs__dbt_tmp" rename to "d_customer_table_prs"
[0m16:18:53.806770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:18:53.808771 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:18:53.809770 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:18:53.809770 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:18:53.810770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:18:53.814769 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:18:53.814769 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
drop table if exists "postgres"."abu"."d_customer_table_prs__dbt_backup" cascade
[0m16:18:53.815771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:18:53.816772 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.816772 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m16:18:53.817770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019845A011E0>]}
[0m16:18:53.817770 [info ] [Thread-1 (]: 3 of 6 OK created sql table model abu.d_customer_table_prs ..................... [[32mSELECT 2[0m in 0.09s]
[0m16:18:53.819777 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m16:18:53.820771 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_trs
[0m16:18:53.821771 [info ] [Thread-1 (]: 4 of 6 START sql table model abu.d_customer_table_trs .......................... [RUN]
[0m16:18:53.822773 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_trs"
[0m16:18:53.822773 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_trs
[0m16:18:53.822773 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_trs
[0m16:18:53.825771 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_trs"
[0m16:18:53.826772 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.827771 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_trs
[0m16:18:53.831771 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_trs"
[0m16:18:53.832772 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:18:53.832772 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: BEGIN
[0m16:18:53.833772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:53.889772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:18:53.889772 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:18:53.890771 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_trs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:18:53.895771 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:18:53.897770 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:18:53.897770 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs__dbt_tmp" rename to "d_customer_table_trs"
[0m16:18:53.898770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:18:53.900774 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:18:53.900774 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:18:53.901776 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:18:53.902771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:18:53.904770 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:18:53.904770 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
drop table if exists "postgres"."abu"."d_customer_table_trs__dbt_backup" cascade
[0m16:18:53.905770 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:18:53.906770 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.906770 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: Close
[0m16:18:53.907771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019845AC21A0>]}
[0m16:18:53.907771 [info ] [Thread-1 (]: 4 of 6 OK created sql table model abu.d_customer_table_trs ..................... [[32mSELECT 2[0m in 0.09s]
[0m16:18:53.909771 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_trs
[0m16:18:53.910780 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m16:18:53.910780 [info ] [Thread-1 (]: 5 of 6 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m16:18:53.911790 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m16:18:53.911790 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m16:18:53.912771 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m16:18:53.914280 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m16:18:53.916281 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:53.916281 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m16:18:53.932285 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m16:18:53.933283 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:18:53.933283 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m16:18:53.934288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:53.986282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:18:53.987281 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:18:53.987281 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:18:53.992282 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:18:53.996281 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:18:53.996281 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs__dbt_tmp" rename to "d_customer_view_prs"
[0m16:18:53.997282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:18:53.998281 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:18:53.999280 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:18:53.999280 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:18:54.000282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:18:54.002282 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:18:54.002282 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
drop view if exists "postgres"."abu"."d_customer_view_prs__dbt_backup" cascade
[0m16:18:54.003281 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:18:54.004281 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:54.004281 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m16:18:54.005281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019845AFB760>]}
[0m16:18:54.005281 [info ] [Thread-1 (]: 5 of 6 OK created sql view model abu.d_customer_view_prs ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:18:54.007281 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m16:18:54.008284 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_trs
[0m16:18:54.008284 [info ] [Thread-1 (]: 6 of 6 START sql view model abu.d_customer_view_trs ............................ [RUN]
[0m16:18:54.009282 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_trs"
[0m16:18:54.010282 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_trs
[0m16:18:54.010282 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_trs
[0m16:18:54.013282 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_trs"
[0m16:18:54.014281 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:54.015282 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_trs
[0m16:18:54.018281 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_trs"
[0m16:18:54.019281 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:18:54.020282 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: BEGIN
[0m16:18:54.020282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:54.073282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:18:54.073282 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:18:54.074282 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */

  create view "postgres"."abu"."d_customer_view_trs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:18:54.078281 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:18:54.081280 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:18:54.081280 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs__dbt_tmp" rename to "d_customer_view_trs"
[0m16:18:54.082281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:18:54.083282 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:18:54.083282 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:18:54.084281 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:18:54.085282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:18:54.087280 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:18:54.087280 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
drop view if exists "postgres"."abu"."d_customer_view_trs__dbt_backup" cascade
[0m16:18:54.087280 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:18:54.088281 [debug] [Thread-1 (]: finished collecting timing info
[0m16:18:54.089281 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: Close
[0m16:18:54.089281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d6ee94-15da-4894-8927-1030e34ab1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019845ADD4E0>]}
[0m16:18:54.090283 [info ] [Thread-1 (]: 6 of 6 OK created sql view model abu.d_customer_view_trs ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:18:54.091296 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_trs
[0m16:18:54.093281 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:18:54.093281 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.093281 [debug] [MainThread]: On master: BEGIN
[0m16:18:54.094281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:54.145281 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:18:54.146282 [debug] [MainThread]: On master: COMMIT
[0m16:18:54.146282 [debug] [MainThread]: Using postgres connection "master"
[0m16:18:54.146282 [debug] [MainThread]: On master: COMMIT
[0m16:18:54.147281 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:18:54.147281 [debug] [MainThread]: On master: Close
[0m16:18:54.148280 [info ] [MainThread]: 
[0m16:18:54.149287 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m16:18:54.151284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:54.152283 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:18:54.152283 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:18:54.152283 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_trs' was properly closed.
[0m16:18:54.159282 [info ] [MainThread]: 
[0m16:18:54.159282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:18:54.160283 [info ] [MainThread]: 
[0m16:18:54.161283 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:18:54.162283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019845A43D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984593BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019845A016F0>]}
[0m16:18:54.162283 [debug] [MainThread]: Flushing usage events
[0m16:18:56.102886 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:19:00.232883 | bec344d6-809e-41d2-b5d6-3302d31f060c ==============================
[0m16:19:00.232883 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:19:00.232883 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m16:19:00.233882 [debug] [MainThread]: Tracking: tracking
[0m16:19:00.261903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E999E7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E999E61D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E999E4D90>]}
[0m16:19:00.358883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:00.358883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:00.359883 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:19:00.365883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bec344d6-809e-41d2-b5d6-3302d31f060c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E99C9E980>]}
[0m16:19:00.372883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bec344d6-809e-41d2-b5d6-3302d31f060c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E96EC58A0>]}
[0m16:19:00.372883 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:19:00.373884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec344d6-809e-41d2-b5d6-3302d31f060c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E960FE4D0>]}
[0m16:19:00.375883 [info ] [MainThread]: 
[0m16:19:00.381883 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:00.383883 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:19:00.393881 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:19:00.394882 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:19:00.394882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:00.456882 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m16:19:00.458882 [debug] [ThreadPool]: On list_postgres: Close
[0m16:19:00.460883 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:19:00.465883 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:19:00.465883 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:19:00.466883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:00.516883 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:19:00.517884 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:19:00.517884 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:19:00.524883 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m16:19:00.525883 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:19:00.526884 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:19:00.530882 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:00.531882 [debug] [MainThread]: On master: BEGIN
[0m16:19:00.531882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:00.587883 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:19:00.588883 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:00.588883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:00.633881 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m16:19:00.635883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec344d6-809e-41d2-b5d6-3302d31f060c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E999E7D90>]}
[0m16:19:00.635883 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:00.635883 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:00.636882 [debug] [MainThread]: On master: BEGIN
[0m16:19:00.636882 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:00.637883 [debug] [MainThread]: On master: COMMIT
[0m16:19:00.637883 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:00.637883 [debug] [MainThread]: On master: COMMIT
[0m16:19:00.638883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:00.638883 [debug] [MainThread]: On master: Close
[0m16:19:00.638883 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:19:00.639883 [info ] [MainThread]: 
[0m16:19:00.650882 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_prs_snapshot
[0m16:19:00.651882 [info ] [Thread-1 (]: 1 of 2 START snapshot abu.customer_prs_snapshot ................................ [RUN]
[0m16:19:00.652884 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:00.652884 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_prs_snapshot
[0m16:19:00.652884 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_prs_snapshot
[0m16:19:00.655882 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:00.656883 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_prs_snapshot
[0m16:19:00.700884 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:00.701882 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:00.701882 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: BEGIN
[0m16:19:00.701882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:00.753883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:19:00.753883 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:00.754884 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_prs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m16:19:00.773882 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.02 seconds
[0m16:19:00.790916 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m16:19:00.790916 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:00.790916 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m16:19:00.792883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:00.792883 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:00.793912 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: Close
[0m16:19:00.793912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec344d6-809e-41d2-b5d6-3302d31f060c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E99AE12D0>]}
[0m16:19:00.794883 [info ] [Thread-1 (]: 1 of 2 OK snapshotted abu.customer_prs_snapshot ................................ [[32mSELECT 2[0m in 0.14s]
[0m16:19:00.795883 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_prs_snapshot
[0m16:19:00.796883 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_trs_snapshot
[0m16:19:00.796883 [info ] [Thread-1 (]: 2 of 2 START snapshot abu.customer_trs_snapshot ................................ [RUN]
[0m16:19:00.797883 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:00.798883 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_trs_snapshot
[0m16:19:00.798883 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_trs_snapshot
[0m16:19:00.801882 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:00.801882 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_trs_snapshot
[0m16:19:00.804882 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:00.806882 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:00.806882 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: BEGIN
[0m16:19:00.806882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:00.965682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.16 seconds
[0m16:19:00.965682 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:00.965682 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      
  
    

  create  table "postgres"."abu"."customer_trs_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m16:19:00.979963 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:19:00.982474 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m16:19:00.982474 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:00.982474 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m16:19:00.983475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:00.984475 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:00.984475 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: Close
[0m16:19:00.985476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec344d6-809e-41d2-b5d6-3302d31f060c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E99CEA620>]}
[0m16:19:00.986474 [info ] [Thread-1 (]: 2 of 2 OK snapshotted abu.customer_trs_snapshot ................................ [[32mSELECT 2[0m in 0.19s]
[0m16:19:00.987474 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_trs_snapshot
[0m16:19:00.989476 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:00.989476 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:00.990476 [debug] [MainThread]: On master: BEGIN
[0m16:19:00.990476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:01.168257 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
[0m16:19:01.169258 [debug] [MainThread]: On master: COMMIT
[0m16:19:01.169258 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:01.169258 [debug] [MainThread]: On master: COMMIT
[0m16:19:01.170256 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:01.170256 [debug] [MainThread]: On master: Close
[0m16:19:01.171256 [info ] [MainThread]: 
[0m16:19:01.172257 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m16:19:01.174258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:01.175259 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:19:01.175259 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:19:01.175259 [debug] [MainThread]: Connection 'snapshot.scenarios.customer_trs_snapshot' was properly closed.
[0m16:19:01.183286 [info ] [MainThread]: 
[0m16:19:01.184269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:01.184269 [info ] [MainThread]: 
[0m16:19:01.194363 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:19:01.195368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E99CF5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E99CF70A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E99CF6890>]}
[0m16:19:01.195368 [debug] [MainThread]: Flushing usage events
[0m16:19:01.602325 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:19:26.235586 | 515e2e17-fcaf-4f13-8e76-6696a0c93d68 ==============================
[0m16:19:26.235586 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:19:26.235586 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:19:26.236586 [debug] [MainThread]: Tracking: tracking
[0m16:19:26.256586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A607F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A6064A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A607CA0>]}
[0m16:19:26.343618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:26.343618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:26.344587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:19:26.350586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A8BA950>]}
[0m16:19:26.356586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A6F91B0>]}
[0m16:19:26.357586 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:19:26.358587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A894250>]}
[0m16:19:26.359616 [info ] [MainThread]: 
[0m16:19:26.368586 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:26.370625 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:19:26.380617 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:19:26.380617 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:19:26.380617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:26.449101 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.07 seconds
[0m16:19:26.451101 [debug] [ThreadPool]: On list_postgres: Close
[0m16:19:26.453101 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:19:26.458101 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:19:26.458101 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:19:26.458101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:26.508101 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:19:26.509100 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:19:26.509100 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:19:26.516100 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.01 seconds
[0m16:19:26.517110 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:19:26.518100 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:19:26.522101 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.522101 [debug] [MainThread]: On master: BEGIN
[0m16:19:26.523101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:26.576103 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:19:26.576103 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.576103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:26.620101 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m16:19:26.621101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A877AF0>]}
[0m16:19:26.622100 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:26.622100 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.622100 [debug] [MainThread]: On master: BEGIN
[0m16:19:26.623101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.623101 [debug] [MainThread]: On master: COMMIT
[0m16:19:26.623101 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:26.624101 [debug] [MainThread]: On master: COMMIT
[0m16:19:26.624101 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:26.624101 [debug] [MainThread]: On master: Close
[0m16:19:26.625101 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:19:26.626101 [info ] [MainThread]: 
[0m16:19:26.636101 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m16:19:26.637101 [info ] [Thread-1 (]: 1 of 6 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m16:19:26.638100 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.638100 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m16:19:26.638100 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m16:19:26.646102 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.647101 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:26.648101 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m16:19:26.700134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.701135 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

    
  
    

  create temporary table "d_customer_incremental_prs__dbt_tmp171926672130"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
    
    -- filter for an incremental run to get new data
    

    where insertedat > (select max(insertedat) from "postgres"."abu"."d_customer_incremental_prs")

    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:19:26.701135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:26.760101 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.06 seconds
[0m16:19:26.766100 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.767118 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m16:19:26.769101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.769101 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.770102 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_prs__dbt_tmp171926672130'
        
      order by ordinal_position

  
[0m16:19:26.788101 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.02 seconds
[0m16:19:26.792100 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.793106 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_prs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:26.795101 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:19:26.802134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.802134 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_prs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:26.805101 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:19:26.815136 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.816137 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.816137 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      insert into "postgres"."abu"."d_customer_incremental_prs" ("customerid", "customername", "insertedat")
    (
        select "customerid", "customername", "insertedat"
        from "d_customer_incremental_prs__dbt_tmp171926672130"
    )


  
[0m16:19:26.817128 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:19:26.830100 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:19:26.830100 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:19:26.830100 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:19:26.832100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:26.832100 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:26.832100 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m16:19:26.833101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A9100A0>]}
[0m16:19:26.834101 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model abu.d_customer_incremental_prs ......... [[32mINSERT 0 2[0m in 0.20s]
[0m16:19:26.835106 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m16:19:26.836103 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_trs
[0m16:19:26.836103 [info ] [Thread-1 (]: 2 of 6 START sql incremental model abu.d_customer_incremental_trs .............. [RUN]
[0m16:19:26.837108 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.838104 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_trs
[0m16:19:26.838104 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_trs
[0m16:19:26.842101 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.844102 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:26.844102 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_trs
[0m16:19:26.849100 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.849100 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

    
  
    

  create temporary table "d_customer_incremental_trs__dbt_tmp171926846100"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

    --where insertedat > (select max(insertedat) from "postgres"."abu"."d_customer_incremental_trs")

    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:19:26.849100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:26.913105 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.06 seconds
[0m16:19:26.916132 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.917101 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: BEGIN
[0m16:19:26.919101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:19:26.919101 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.920136 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_trs__dbt_tmp171926846100'
        
      order by ordinal_position

  
[0m16:19:26.938101 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.02 seconds
[0m16:19:26.941100 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.941100 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_trs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:26.944101 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:19:26.947102 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.947102 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_trs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:26.950101 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:19:26.952136 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.953134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.953134 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      insert into "postgres"."abu"."d_customer_incremental_trs" ("customerid", "customername", "insertedat")
    (
        select "customerid", "customername", "insertedat"
        from "d_customer_incremental_trs__dbt_tmp171926846100"
    )


  
[0m16:19:26.954101 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:19:26.956134 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:19:26.956134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:19:26.957102 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:19:26.958101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:26.958101 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:26.959102 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: Close
[0m16:19:26.959102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A99B400>]}
[0m16:19:26.960101 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model abu.d_customer_incremental_trs ......... [[32mINSERT 0 2[0m in 0.12s]
[0m16:19:26.962112 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_trs
[0m16:19:26.962112 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m16:19:26.963102 [info ] [Thread-1 (]: 3 of 6 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m16:19:26.964101 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m16:19:26.964101 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m16:19:26.964101 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m16:19:26.967153 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m16:19:26.968137 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:26.968137 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m16:19:26.980137 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m16:19:26.981134 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:19:26.981134 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m16:19:26.982102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:27.045276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:19:27.045276 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:19:27.046276 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:19:27.051434 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.01 seconds
[0m16:19:27.057435 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:19:27.057435 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs" rename to "d_customer_table_prs__dbt_backup"
[0m16:19:27.058434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.060435 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:19:27.060435 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs__dbt_tmp" rename to "d_customer_table_prs"
[0m16:19:27.061434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.069433 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:19:27.070435 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:19:27.070435 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:19:27.071435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:27.075434 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:19:27.076435 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
drop table if exists "postgres"."abu"."d_customer_table_prs__dbt_backup" cascade
[0m16:19:27.079433 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:27.080466 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:27.080466 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m16:19:27.081466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399AA194E0>]}
[0m16:19:27.082433 [info ] [Thread-1 (]: 3 of 6 OK created sql table model abu.d_customer_table_prs ..................... [[32mSELECT 4[0m in 0.12s]
[0m16:19:27.083433 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m16:19:27.084434 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_trs
[0m16:19:27.084434 [info ] [Thread-1 (]: 4 of 6 START sql table model abu.d_customer_table_trs .......................... [RUN]
[0m16:19:27.085433 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_trs"
[0m16:19:27.085433 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_trs
[0m16:19:27.086435 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_trs
[0m16:19:27.088468 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_trs"
[0m16:19:27.089434 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:27.090464 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_trs
[0m16:19:27.094440 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_trs"
[0m16:19:27.095435 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:19:27.096434 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: BEGIN
[0m16:19:27.096434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:27.253012 [debug] [Thread-1 (]: SQL status: BEGIN in 0.16 seconds
[0m16:19:27.253012 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:19:27.254014 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_trs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:19:27.259012 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m16:19:27.261011 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:19:27.262013 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs" rename to "d_customer_table_trs__dbt_backup"
[0m16:19:27.262013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.264012 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:19:27.264012 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs__dbt_tmp" rename to "d_customer_table_trs"
[0m16:19:27.265012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.267015 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:19:27.268013 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:19:27.268013 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:19:27.269460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:27.270466 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:19:27.271463 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
drop table if exists "postgres"."abu"."d_customer_table_trs__dbt_backup" cascade
[0m16:19:27.273616 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:27.274648 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:27.274648 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: Close
[0m16:19:27.275617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A8F3A30>]}
[0m16:19:27.275617 [info ] [Thread-1 (]: 4 of 6 OK created sql table model abu.d_customer_table_trs ..................... [[32mSELECT 2[0m in 0.19s]
[0m16:19:27.277616 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_trs
[0m16:19:27.278617 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m16:19:27.278617 [info ] [Thread-1 (]: 5 of 6 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m16:19:27.279616 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m16:19:27.280616 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m16:19:27.280616 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m16:19:27.283615 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m16:19:27.284616 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:27.284616 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m16:19:27.301644 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m16:19:27.302644 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:19:27.302644 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m16:19:27.303649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:27.357652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:19:27.357652 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:19:27.357652 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:19:27.363616 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:27.366615 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:19:27.366615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs" rename to "d_customer_view_prs__dbt_backup"
[0m16:19:27.367616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.369615 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:19:27.369615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs__dbt_tmp" rename to "d_customer_view_prs"
[0m16:19:27.370616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.371616 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:19:27.372615 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:19:27.372615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:19:27.373616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:27.375615 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:19:27.375615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
drop view if exists "postgres"."abu"."d_customer_view_prs__dbt_backup" cascade
[0m16:19:27.377616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:27.378616 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:27.378616 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m16:19:27.379616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399AA2F130>]}
[0m16:19:27.380616 [info ] [Thread-1 (]: 5 of 6 OK created sql view model abu.d_customer_view_prs ....................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:19:27.381616 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m16:19:27.382618 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_trs
[0m16:19:27.382618 [info ] [Thread-1 (]: 6 of 6 START sql view model abu.d_customer_view_trs ............................ [RUN]
[0m16:19:27.383617 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_trs"
[0m16:19:27.383617 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_trs
[0m16:19:27.383617 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_trs
[0m16:19:27.386615 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_trs"
[0m16:19:27.387616 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:27.387616 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_trs
[0m16:19:27.392618 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_trs"
[0m16:19:27.393631 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:19:27.393631 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: BEGIN
[0m16:19:27.394618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:27.445614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:19:27.445614 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:19:27.446615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */

  create view "postgres"."abu"."d_customer_view_trs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:19:27.452615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:19:27.455615 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:19:27.455615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs" rename to "d_customer_view_trs__dbt_backup"
[0m16:19:27.456615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.458615 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:19:27.458615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs__dbt_tmp" rename to "d_customer_view_trs"
[0m16:19:27.458615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:27.460615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:19:27.461615 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:19:27.461615 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:19:27.462615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:27.464614 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:19:27.464614 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
drop view if exists "postgres"."abu"."d_customer_view_trs__dbt_backup" cascade
[0m16:19:27.465615 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:27.466614 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:27.466614 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: Close
[0m16:19:27.467614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515e2e17-fcaf-4f13-8e76-6696a0c93d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399A9D63B0>]}
[0m16:19:27.468615 [info ] [Thread-1 (]: 6 of 6 OK created sql view model abu.d_customer_view_trs ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:19:27.469626 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_trs
[0m16:19:27.471616 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:27.471616 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:27.471616 [debug] [MainThread]: On master: BEGIN
[0m16:19:27.472615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:27.523616 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:19:27.523616 [debug] [MainThread]: On master: COMMIT
[0m16:19:27.524617 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:27.524617 [debug] [MainThread]: On master: COMMIT
[0m16:19:27.525616 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:27.525616 [debug] [MainThread]: On master: Close
[0m16:19:27.526617 [info ] [MainThread]: 
[0m16:19:27.526617 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m16:19:27.535616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:27.536617 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:19:27.536617 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:19:27.536617 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_trs' was properly closed.
[0m16:19:27.544616 [info ] [MainThread]: 
[0m16:19:27.544616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:27.545619 [info ] [MainThread]: 
[0m16:19:27.546617 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:19:27.546617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399AA53370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399AA53CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001399AA53D60>]}
[0m16:19:27.547617 [debug] [MainThread]: Flushing usage events
[0m16:19:27.674600 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:19:34.135911 | 4893f09b-2b8b-460e-b2a7-84562ec8b8dd ==============================
[0m16:19:34.135911 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:19:34.136911 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m16:19:34.136911 [debug] [MainThread]: Tracking: tracking
[0m16:19:34.158912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302EF1BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302EF19690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302EF18CD0>]}
[0m16:19:34.248944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:34.249949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:34.249949 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:19:34.255912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4893f09b-2b8b-460e-b2a7-84562ec8b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F1CA920>]}
[0m16:19:34.262912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4893f09b-2b8b-460e-b2a7-84562ec8b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F00ABF0>]}
[0m16:19:34.262912 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:19:34.263913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4893f09b-2b8b-460e-b2a7-84562ec8b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F1A4040>]}
[0m16:19:34.264913 [info ] [MainThread]: 
[0m16:19:34.265921 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:34.268911 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:19:34.277946 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:19:34.278948 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:19:34.278948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:34.347911 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.07 seconds
[0m16:19:34.348912 [debug] [ThreadPool]: On list_postgres: Close
[0m16:19:34.351911 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:19:34.356911 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:19:34.356911 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:19:34.356911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:34.409912 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:19:34.409912 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:19:34.410912 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:19:34.417912 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.01 seconds
[0m16:19:34.418912 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:19:34.419911 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:19:34.423911 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:34.423911 [debug] [MainThread]: On master: BEGIN
[0m16:19:34.424911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:34.474912 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:19:34.475927 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:34.475927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:34.520911 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m16:19:34.521945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4893f09b-2b8b-460e-b2a7-84562ec8b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302EF1BE20>]}
[0m16:19:34.521945 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:34.522944 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:34.522944 [debug] [MainThread]: On master: BEGIN
[0m16:19:34.523941 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:34.523941 [debug] [MainThread]: On master: COMMIT
[0m16:19:34.523941 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:34.524944 [debug] [MainThread]: On master: COMMIT
[0m16:19:34.524944 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.524944 [debug] [MainThread]: On master: Close
[0m16:19:34.525944 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:19:34.526912 [info ] [MainThread]: 
[0m16:19:34.537911 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_prs_snapshot
[0m16:19:34.538912 [info ] [Thread-1 (]: 1 of 2 START snapshot abu.customer_prs_snapshot ................................ [RUN]
[0m16:19:34.538912 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.539924 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_prs_snapshot
[0m16:19:34.539924 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_prs_snapshot
[0m16:19:34.542944 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:34.542944 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_prs_snapshot
[0m16:19:34.601917 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.602924 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: BEGIN
[0m16:19:34.603917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:34.671913 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m16:19:34.672913 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.672913 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'customer_prs_snapshot'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:34.691912 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m16:19:34.715912 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.716912 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

        
  
    

  create temporary table "customer_prs_snapshot__dbt_tmp171934704912"
  as (
    with snapshot_query as (

        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c


    ),

    snapshotted_data as (

        select *,
            customerid as dbt_unique_key

        from "postgres"."abu"."customer_prs_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            nullif(insertedat, insertedat) as dbt_valid_to,
            md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            insertedat as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.insertedat)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.insertedat)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:19:34.726912 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.01 seconds
[0m16:19:34.728912 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.729910 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customer_prs_snapshot__dbt_tmp171934704912'
        
      order by ordinal_position

  
[0m16:19:34.732914 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:34.735910 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.735910 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'customer_prs_snapshot'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:34.738912 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:19:34.741910 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.741910 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customer_prs_snapshot__dbt_tmp171934704912'
        
      order by ordinal_position

  
[0m16:19:34.744912 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:34.747914 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.748911 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'customer_prs_snapshot'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:34.751912 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:19:34.757913 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.758914 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customer_prs_snapshot__dbt_tmp171934704912'
        
      order by ordinal_position

  
[0m16:19:34.760911 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:34.766914 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.767913 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.767913 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_prs_snapshot"} */

      update "postgres"."abu"."customer_prs_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customer_prs_snapshot__dbt_tmp171934704912" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."abu"."customer_prs_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."abu"."customer_prs_snapshot".dbt_valid_to is null;

    insert into "postgres"."abu"."customer_prs_snapshot" ("customerid", "customername", "insertedat", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customerid",DBT_INTERNAL_SOURCE."customername",DBT_INTERNAL_SOURCE."insertedat",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customer_prs_snapshot__dbt_tmp171934704912" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:19:34.768913 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:19:34.782915 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m16:19:34.782915 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_prs_snapshot"
[0m16:19:34.782915 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: COMMIT
[0m16:19:34.784912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.786948 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:34.787945 [debug] [Thread-1 (]: On snapshot.scenarios.customer_prs_snapshot: Close
[0m16:19:34.787945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4893f09b-2b8b-460e-b2a7-84562ec8b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F2C26B0>]}
[0m16:19:34.788912 [info ] [Thread-1 (]: 1 of 2 OK snapshotted abu.customer_prs_snapshot ................................ [[32mINSERT 0 2[0m in 0.25s]
[0m16:19:34.790912 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_prs_snapshot
[0m16:19:34.790912 [debug] [Thread-1 (]: Began running node snapshot.scenarios.customer_trs_snapshot
[0m16:19:34.791912 [info ] [Thread-1 (]: 2 of 2 START snapshot abu.customer_trs_snapshot ................................ [RUN]
[0m16:19:34.792912 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.792912 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.customer_trs_snapshot
[0m16:19:34.792912 [debug] [Thread-1 (]: Compiling snapshot.scenarios.customer_trs_snapshot
[0m16:19:34.795912 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:34.796911 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.customer_trs_snapshot
[0m16:19:34.800942 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.801912 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: BEGIN
[0m16:19:34.801912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:34.852547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:19:34.853546 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.853546 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'customer_trs_snapshot'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:34.870547 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m16:19:34.873546 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.873546 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

        
  
    

  create temporary table "customer_trs_snapshot__dbt_tmp171934872546"
  as (
    with snapshot_query as (

        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c


    ),

    snapshotted_data as (

        select *,
            customerid as dbt_unique_key

        from "postgres"."abu"."customer_trs_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            nullif(insertedat, insertedat) as dbt_valid_to,
            md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            insertedat as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.insertedat)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.insertedat)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:19:34.882547 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.01 seconds
[0m16:19:34.885550 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.885550 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customer_trs_snapshot__dbt_tmp171934872546'
        
      order by ordinal_position

  
[0m16:19:34.889547 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:34.892549 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.892549 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'customer_trs_snapshot'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:34.896560 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:19:34.899548 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.900549 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customer_trs_snapshot__dbt_tmp171934872546'
        
      order by ordinal_position

  
[0m16:19:34.903549 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:34.906550 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.907550 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'customer_trs_snapshot'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:19:34.910576 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:19:34.915551 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.915551 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customer_trs_snapshot__dbt_tmp171934872546'
        
      order by ordinal_position

  
[0m16:19:34.918577 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:34.921549 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.922550 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.922550 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.customer_trs_snapshot"} */

      update "postgres"."abu"."customer_trs_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customer_trs_snapshot__dbt_tmp171934872546" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."abu"."customer_trs_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."abu"."customer_trs_snapshot".dbt_valid_to is null;

    insert into "postgres"."abu"."customer_trs_snapshot" ("customerid", "customername", "insertedat", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customerid",DBT_INTERNAL_SOURCE."customername",DBT_INTERNAL_SOURCE."insertedat",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customer_trs_snapshot__dbt_tmp171934872546" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:19:34.923549 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:19:34.925575 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m16:19:34.925575 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.customer_trs_snapshot"
[0m16:19:34.926579 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: COMMIT
[0m16:19:34.927547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.928547 [debug] [Thread-1 (]: finished collecting timing info
[0m16:19:34.928547 [debug] [Thread-1 (]: On snapshot.scenarios.customer_trs_snapshot: Close
[0m16:19:34.929582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4893f09b-2b8b-460e-b2a7-84562ec8b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F324070>]}
[0m16:19:34.929582 [info ] [Thread-1 (]: 2 of 2 OK snapshotted abu.customer_trs_snapshot ................................ [[32mINSERT 0 2[0m in 0.14s]
[0m16:19:34.931564 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.customer_trs_snapshot
[0m16:19:34.933555 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:19:34.934579 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:34.934579 [debug] [MainThread]: On master: BEGIN
[0m16:19:34.935547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:34.986547 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:19:34.987599 [debug] [MainThread]: On master: COMMIT
[0m16:19:34.987599 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:34.987599 [debug] [MainThread]: On master: COMMIT
[0m16:19:34.988555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.988555 [debug] [MainThread]: On master: Close
[0m16:19:34.989555 [info ] [MainThread]: 
[0m16:19:34.989555 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m16:19:34.992556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:34.992556 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:19:34.992556 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:19:34.993556 [debug] [MainThread]: Connection 'snapshot.scenarios.customer_trs_snapshot' was properly closed.
[0m16:19:34.999557 [info ] [MainThread]: 
[0m16:19:35.000556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:35.001555 [info ] [MainThread]: 
[0m16:19:35.002555 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:19:35.002555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F144040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F3240A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001302F30F280>]}
[0m16:19:35.003556 [debug] [MainThread]: Flushing usage events
[0m16:19:37.107745 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:30:24.736894 | 64794b09-c7e9-4576-aebe-c22bdb9920d1 ==============================
[0m16:30:24.736894 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:30:24.737895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:30:24.737895 [debug] [MainThread]: Tracking: tracking
[0m16:30:24.758895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002915A62FE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002915A62D690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002915A62CCD0>]}
[0m16:30:24.847928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:30:24.848936 [debug] [MainThread]: Partial parsing: updated file: scenarios://snapshots\d_customer_snapshot_trs.sql
[0m16:30:24.848936 [debug] [MainThread]: Partial parsing: updated file: scenarios://snapshots\d_customer_snapshot_prs.sql
[0m16:30:24.875927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002915A8B47C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002915A8DA830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002915A91BFD0>]}
[0m16:30:24.875927 [debug] [MainThread]: Flushing usage events
[0m16:30:25.013718 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:30:25.014680 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two snapshots with the name "d_customer_snapshot_prs".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("d_customer_snapshot_prs").
  
  To fix this, change the name of one of these resources:
  - snapshot.scenarios.d_customer_snapshot_prs (snapshots\d_customer_snapshot_prs.sql)
  - snapshot.scenarios.d_customer_snapshot_prs (snapshots\d_customer_snapshot_trs.sql)


============================== 2022-11-27 16:30:55.157013 | 6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1 ==============================
[0m16:30:55.157013 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:30:55.158013 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:30:55.158013 [debug] [MainThread]: Tracking: tracking
[0m16:30:55.178980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018193377F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181933764A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018193377CA0>]}
[0m16:30:55.271979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:30:55.272980 [debug] [MainThread]: Partial parsing: updated file: scenarios://snapshots\d_customer_snapshot_trs.sql
[0m16:30:55.272980 [debug] [MainThread]: Partial parsing: updated file: scenarios://snapshots\d_customer_snapshot_prs.sql
[0m16:30:55.310988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:30:55.316008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018193614280>]}
[0m16:30:55.323015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181935D5D50>]}
[0m16:30:55.323980 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:30:55.325013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181935D5C60>]}
[0m16:30:55.326980 [info ] [MainThread]: 
[0m16:30:55.334980 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:30:55.336979 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:30:55.345979 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:30:55.345979 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:30:55.346980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:55.406979 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.06 seconds
[0m16:30:55.408003 [debug] [ThreadPool]: On list_postgres: Close
[0m16:30:55.409979 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:30:55.414980 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:30:55.415979 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:30:55.415979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:55.466013 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:30:55.466981 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:30:55.466981 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:30:55.472979 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m16:30:55.474980 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:30:55.474980 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:30:55.479980 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:55.479980 [debug] [MainThread]: On master: BEGIN
[0m16:30:55.479980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:55.538980 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:30:55.538980 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:55.539982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:55.576981 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m16:30:55.577981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181936179D0>]}
[0m16:30:55.578981 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:55.578981 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:55.580016 [debug] [MainThread]: On master: BEGIN
[0m16:30:55.580016 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:30:55.580982 [debug] [MainThread]: On master: COMMIT
[0m16:30:55.580982 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:55.580982 [debug] [MainThread]: On master: COMMIT
[0m16:30:55.581983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:55.581983 [debug] [MainThread]: On master: Close
[0m16:30:55.581983 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:30:55.583013 [info ] [MainThread]: 
[0m16:30:55.593983 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m16:30:55.594980 [info ] [Thread-1 (]: 1 of 6 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m16:30:55.596980 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:30:55.597980 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m16:30:55.597980 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m16:30:55.604980 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m16:30:55.605984 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:55.605984 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m16:30:55.652012 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m16:30:55.653013 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:30:55.653986 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m16:30:55.653986 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:30:55.707015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:30:55.707981 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:30:55.707981 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_prs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:30:55.715013 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:30:55.731013 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:30:55.732019 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:30:55.732019 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:30:55.734008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:55.735008 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:55.735008 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m16:30:55.735981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181935EB5B0>]}
[0m16:30:55.735981 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model abu.d_customer_incremental_prs ......... [[32mSELECT 2[0m in 0.14s]
[0m16:30:55.737980 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m16:30:55.738982 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_trs
[0m16:30:55.738982 [info ] [Thread-1 (]: 2 of 6 START sql incremental model abu.d_customer_incremental_trs .............. [RUN]
[0m16:30:55.739981 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:30:55.739981 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_trs
[0m16:30:55.740982 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_trs
[0m16:30:55.743979 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_trs"
[0m16:30:55.744980 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:55.744980 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_trs
[0m16:30:55.749980 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_trs"
[0m16:30:55.750981 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:30:55.750981 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: BEGIN
[0m16:30:55.751980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:55.801980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:30:55.802980 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:30:55.802980 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_incremental_trs"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:30:55.809979 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:30:55.811980 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:30:55.811980 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:30:55.811980 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:30:55.812980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:55.813980 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:55.813980 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: Close
[0m16:30:55.814980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018193628970>]}
[0m16:30:55.814980 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model abu.d_customer_incremental_trs ......... [[32mSELECT 2[0m in 0.07s]
[0m16:30:55.816982 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_trs
[0m16:30:55.817980 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m16:30:55.817980 [info ] [Thread-1 (]: 3 of 6 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m16:30:55.818981 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m16:30:55.818981 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m16:30:55.819980 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m16:30:55.821979 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m16:30:55.822980 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:55.822980 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m16:30:55.835983 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m16:30:55.837014 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:30:55.837014 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m16:30:55.837981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:55.888009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:30:55.888009 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:30:55.888009 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:30:55.894013 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:30:55.899982 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:30:55.899982 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs__dbt_tmp" rename to "d_customer_table_prs"
[0m16:30:55.901980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:55.903981 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:30:55.903981 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:30:55.904980 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:30:55.905980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:55.910981 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:30:55.910981 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
drop table if exists "postgres"."abu"."d_customer_table_prs__dbt_backup" cascade
[0m16:30:55.911980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:30:55.913984 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:55.914987 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m16:30:55.915981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018193669D20>]}
[0m16:30:55.915981 [info ] [Thread-1 (]: 3 of 6 OK created sql table model abu.d_customer_table_prs ..................... [[32mSELECT 2[0m in 0.10s]
[0m16:30:55.917980 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m16:30:55.918985 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_trs
[0m16:30:55.918985 [info ] [Thread-1 (]: 4 of 6 START sql table model abu.d_customer_table_trs .......................... [RUN]
[0m16:30:55.919982 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_trs"
[0m16:30:55.920980 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_trs
[0m16:30:55.920980 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_trs
[0m16:30:55.923981 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_trs"
[0m16:30:55.924981 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:55.924981 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_trs
[0m16:30:55.930980 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_trs"
[0m16:30:55.932980 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:30:55.932980 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: BEGIN
[0m16:30:55.932980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:55.985979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:30:55.986980 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:30:55.986980 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_trs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:30:55.992979 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:30:55.995980 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:30:55.995980 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs__dbt_tmp" rename to "d_customer_table_trs"
[0m16:30:55.996980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:55.997981 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:30:55.998980 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:30:55.998980 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:30:56.000980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:56.001981 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:30:56.002980 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
drop table if exists "postgres"."abu"."d_customer_table_trs__dbt_backup" cascade
[0m16:30:56.002980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:30:56.003980 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:56.003980 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: Close
[0m16:30:56.004980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819366A5F0>]}
[0m16:30:56.004980 [info ] [Thread-1 (]: 4 of 6 OK created sql table model abu.d_customer_table_trs ..................... [[32mSELECT 2[0m in 0.08s]
[0m16:30:56.006980 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_trs
[0m16:30:56.007981 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m16:30:56.007981 [info ] [Thread-1 (]: 5 of 6 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m16:30:56.008981 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m16:30:56.008981 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m16:30:56.008981 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m16:30:56.011979 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m16:30:56.012979 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:56.012979 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m16:30:56.029980 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m16:30:56.030981 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:30:56.030981 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m16:30:56.030981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:56.081979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:30:56.082979 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:30:56.082979 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:30:56.088979 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:30:56.090979 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:30:56.090979 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs__dbt_tmp" rename to "d_customer_view_prs"
[0m16:30:56.091980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:56.093979 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:30:56.093979 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:30:56.093979 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:30:56.094980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:56.096979 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:30:56.096979 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
drop view if exists "postgres"."abu"."d_customer_view_prs__dbt_backup" cascade
[0m16:30:56.097981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:30:56.098980 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:56.098980 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m16:30:56.099979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819377A230>]}
[0m16:30:56.099979 [info ] [Thread-1 (]: 5 of 6 OK created sql view model abu.d_customer_view_prs ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:30:56.101984 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m16:30:56.102981 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_trs
[0m16:30:56.102981 [info ] [Thread-1 (]: 6 of 6 START sql view model abu.d_customer_view_trs ............................ [RUN]
[0m16:30:56.103981 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_trs"
[0m16:30:56.104980 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_trs
[0m16:30:56.104980 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_trs
[0m16:30:56.106980 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_trs"
[0m16:30:56.107981 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:56.108982 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_trs
[0m16:30:56.112013 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_trs"
[0m16:30:56.113014 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:30:56.113995 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: BEGIN
[0m16:30:56.113995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:56.167493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:30:56.168494 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:30:56.168494 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */

  create view "postgres"."abu"."d_customer_view_trs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:30:56.173492 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:30:56.176492 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:30:56.176492 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs__dbt_tmp" rename to "d_customer_view_trs"
[0m16:30:56.177493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:30:56.178492 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:30:56.178492 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:30:56.179493 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:30:56.180495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:30:56.182495 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:30:56.183495 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
drop view if exists "postgres"."abu"."d_customer_view_trs__dbt_backup" cascade
[0m16:30:56.183495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:30:56.185496 [debug] [Thread-1 (]: finished collecting timing info
[0m16:30:56.185496 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: Close
[0m16:30:56.186494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5cf84c-6f0e-4b40-a7aa-bc9e556c69e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018193606E30>]}
[0m16:30:56.186494 [info ] [Thread-1 (]: 6 of 6 OK created sql view model abu.d_customer_view_trs ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:30:56.188494 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_trs
[0m16:30:56.190494 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:30:56.190494 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:56.190494 [debug] [MainThread]: On master: BEGIN
[0m16:30:56.191493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:56.247492 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:30:56.247492 [debug] [MainThread]: On master: COMMIT
[0m16:30:56.248503 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:56.248503 [debug] [MainThread]: On master: COMMIT
[0m16:30:56.248503 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:30:56.249492 [debug] [MainThread]: On master: Close
[0m16:30:56.250492 [info ] [MainThread]: 
[0m16:30:56.251496 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m16:30:56.252503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:56.253497 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:30:56.253497 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:30:56.253497 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_trs' was properly closed.
[0m16:30:56.261494 [info ] [MainThread]: 
[0m16:30:56.262494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:56.263495 [info ] [MainThread]: 
[0m16:30:56.264493 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:30:56.265494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181935EBFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819372AC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819366A440>]}
[0m16:30:56.265494 [debug] [MainThread]: Flushing usage events
[0m16:30:56.411557 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:31:04.635209 | da45cc68-5b6e-4319-a50b-295d4ff28a22 ==============================
[0m16:31:04.635209 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:31:04.636210 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m16:31:04.637213 [debug] [MainThread]: Tracking: tracking
[0m16:31:04.657211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FC77D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FC761A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FC74D60>]}
[0m16:31:04.749070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:04.750070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:04.750070 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:31:04.756071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da45cc68-5b6e-4319-a50b-295d4ff28a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FF2E950>]}
[0m16:31:04.764072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da45cc68-5b6e-4319-a50b-295d4ff28a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FD69D20>]}
[0m16:31:04.764072 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:31:04.765072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da45cc68-5b6e-4319-a50b-295d4ff28a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FF08250>]}
[0m16:31:04.766072 [info ] [MainThread]: 
[0m16:31:04.771074 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:31:04.773073 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:31:04.782106 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:31:04.782106 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:31:04.783073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:04.843071 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.06 seconds
[0m16:31:04.844073 [debug] [ThreadPool]: On list_postgres: Close
[0m16:31:04.846072 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:31:04.851100 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:31:04.852107 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:31:04.852107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:04.903072 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:31:04.904073 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:31:04.904073 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:31:04.910072 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m16:31:04.911073 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:31:04.912071 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:31:04.916071 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:04.917071 [debug] [MainThread]: On master: BEGIN
[0m16:31:04.917071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:04.968072 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:31:04.968072 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:04.969101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:05.011071 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m16:31:05.012072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da45cc68-5b6e-4319-a50b-295d4ff28a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FC77D60>]}
[0m16:31:05.012072 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:05.013072 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.013072 [debug] [MainThread]: On master: BEGIN
[0m16:31:05.014072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:31:05.014072 [debug] [MainThread]: On master: COMMIT
[0m16:31:05.014072 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.014072 [debug] [MainThread]: On master: COMMIT
[0m16:31:05.015097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:31:05.015097 [debug] [MainThread]: On master: Close
[0m16:31:05.016098 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:31:05.017072 [info ] [MainThread]: 
[0m16:31:05.027073 [debug] [Thread-1 (]: Began running node snapshot.scenarios.d_customer_snapshot_prs
[0m16:31:05.027073 [info ] [Thread-1 (]: 1 of 2 START snapshot abu.d_customer_snapshot_prs .............................. [RUN]
[0m16:31:05.028109 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:31:05.028109 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.d_customer_snapshot_prs
[0m16:31:05.029101 [debug] [Thread-1 (]: Compiling snapshot.scenarios.d_customer_snapshot_prs
[0m16:31:05.032107 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:05.032107 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.d_customer_snapshot_prs
[0m16:31:05.072104 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:31:05.073105 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:31:05.073105 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: BEGIN
[0m16:31:05.074113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:31:05.131072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:31:05.132110 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:31:05.132110 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_snapshot_prs"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m16:31:05.144097 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:31:05.160071 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: COMMIT
[0m16:31:05.160071 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:31:05.161071 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: COMMIT
[0m16:31:05.162071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:31:05.162071 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:05.163072 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: Close
[0m16:31:05.163072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da45cc68-5b6e-4319-a50b-295d4ff28a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FD71240>]}
[0m16:31:05.164072 [info ] [Thread-1 (]: 1 of 2 OK snapshotted abu.d_customer_snapshot_prs .............................. [[32mSELECT 2[0m in 0.13s]
[0m16:31:05.166072 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.d_customer_snapshot_prs
[0m16:31:05.166072 [debug] [Thread-1 (]: Began running node snapshot.scenarios.d_customer_snapshot_trs
[0m16:31:05.166072 [info ] [Thread-1 (]: 2 of 2 START snapshot abu.d_customer_snapshot_trs .............................. [RUN]
[0m16:31:05.167071 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:31:05.167071 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.d_customer_snapshot_trs
[0m16:31:05.168072 [debug] [Thread-1 (]: Compiling snapshot.scenarios.d_customer_snapshot_trs
[0m16:31:05.171072 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:05.171072 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.d_customer_snapshot_trs
[0m16:31:05.175071 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:31:05.176071 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:31:05.176071 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: BEGIN
[0m16:31:05.176071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:05.228072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:31:05.229125 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:31:05.229125 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      
  
    

  create  table "postgres"."abu"."d_customer_snapshot_trs"
  as (
    

    select *,
        md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id,
        insertedat as dbt_updated_at,
        insertedat as dbt_valid_from,
        nullif(insertedat, insertedat) as dbt_valid_to
    from (
        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c

    ) sbq



  );
  
  
[0m16:31:05.242113 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:31:05.244113 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: COMMIT
[0m16:31:05.244113 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:31:05.244113 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: COMMIT
[0m16:31:05.245111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:31:05.246081 [debug] [Thread-1 (]: finished collecting timing info
[0m16:31:05.246081 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: Close
[0m16:31:05.247080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da45cc68-5b6e-4319-a50b-295d4ff28a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FF79990>]}
[0m16:31:05.248081 [info ] [Thread-1 (]: 2 of 2 OK snapshotted abu.d_customer_snapshot_trs .............................. [[32mSELECT 2[0m in 0.08s]
[0m16:31:05.249081 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.d_customer_snapshot_trs
[0m16:31:05.251081 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:31:05.251081 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.251081 [debug] [MainThread]: On master: BEGIN
[0m16:31:05.252093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:05.304081 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:31:05.304081 [debug] [MainThread]: On master: COMMIT
[0m16:31:05.304081 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:05.305081 [debug] [MainThread]: On master: COMMIT
[0m16:31:05.305081 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:31:05.305081 [debug] [MainThread]: On master: Close
[0m16:31:05.306081 [info ] [MainThread]: 
[0m16:31:05.307081 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m16:31:05.309086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:05.309086 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:31:05.310081 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:31:05.310081 [debug] [MainThread]: Connection 'snapshot.scenarios.d_customer_snapshot_trs' was properly closed.
[0m16:31:05.318081 [info ] [MainThread]: 
[0m16:31:05.318081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:05.319081 [info ] [MainThread]: 
[0m16:31:05.320082 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:31:05.320082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FF87EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FF84EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E0FF846A0>]}
[0m16:31:05.321082 [debug] [MainThread]: Flushing usage events
[0m16:31:05.456542 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:35:10.074765 | 07095e76-4227-4649-9592-13a7e656a5ba ==============================
[0m16:35:10.074765 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:35:10.075765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:35:10.075765 [debug] [MainThread]: Tracking: tracking
[0m16:35:10.095765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A367DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A3651B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A367A90>]}
[0m16:35:10.181764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:10.181764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:10.182764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:35:10.188770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A61A9B0>]}
[0m16:35:10.195766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD37847A00>]}
[0m16:35:10.195766 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:35:10.196766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD36A7E560>]}
[0m16:35:10.197766 [info ] [MainThread]: 
[0m16:35:10.199780 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:35:10.201768 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:35:10.211794 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:35:10.211794 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:35:10.211794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:10.272764 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.06 seconds
[0m16:35:10.273764 [debug] [ThreadPool]: On list_postgres: Close
[0m16:35:10.275764 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:35:10.282796 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:35:10.283799 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:35:10.283799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:10.334765 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:35:10.335765 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:35:10.335765 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:35:10.341765 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.01 seconds
[0m16:35:10.343765 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:35:10.343765 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:35:10.348764 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:10.348764 [debug] [MainThread]: On master: BEGIN
[0m16:35:10.349765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:10.401765 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:35:10.402765 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:10.402765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:10.447799 [debug] [MainThread]: SQL status: SELECT 2 in 0.05 seconds
[0m16:35:10.448766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A5DF580>]}
[0m16:35:10.448766 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:10.449765 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:10.449765 [debug] [MainThread]: On master: BEGIN
[0m16:35:10.450765 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:35:10.450765 [debug] [MainThread]: On master: COMMIT
[0m16:35:10.451765 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:10.451765 [debug] [MainThread]: On master: COMMIT
[0m16:35:10.451765 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:35:10.452766 [debug] [MainThread]: On master: Close
[0m16:35:10.452766 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:35:10.453766 [info ] [MainThread]: 
[0m16:35:10.468766 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_prs
[0m16:35:10.468766 [info ] [Thread-1 (]: 1 of 6 START sql incremental model abu.d_customer_incremental_prs .............. [RUN]
[0m16:35:10.469806 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.469806 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_prs
[0m16:35:10.470765 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_prs
[0m16:35:10.478765 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.479767 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.480766 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_prs
[0m16:35:10.526799 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.526799 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

    
  
    

  create temporary table "d_customer_incremental_prs__dbt_tmp173510504796"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
    
    -- filter for an incremental run to get new data
    

    where insertedat > (select max(insertedat) from "postgres"."abu"."d_customer_incremental_prs")

    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:35:10.526799 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:10.583765 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.06 seconds
[0m16:35:10.589795 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.589795 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: BEGIN
[0m16:35:10.592765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:35:10.592765 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.592765 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_prs__dbt_tmp173510504796'
        
      order by ordinal_position

  
[0m16:35:10.609765 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.02 seconds
[0m16:35:10.614764 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.614764 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_prs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:10.617765 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:35:10.623764 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.624764 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_prs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:10.626765 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:35:10.636799 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.637801 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.638767 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_prs"} */

      insert into "postgres"."abu"."d_customer_incremental_prs" ("customerid", "customername", "insertedat")
    (
        select "customerid", "customername", "insertedat"
        from "d_customer_incremental_prs__dbt_tmp173510504796"
    )


  
[0m16:35:10.639796 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:35:10.652801 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:35:10.652801 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_prs"
[0m16:35:10.652801 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: COMMIT
[0m16:35:10.660765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m16:35:10.660765 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.661779 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_prs: Close
[0m16:35:10.661779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A670100>]}
[0m16:35:10.662766 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model abu.d_customer_incremental_prs ......... [[32mINSERT 0 2[0m in 0.19s]
[0m16:35:10.664766 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_prs
[0m16:35:10.664766 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_incremental_trs
[0m16:35:10.665768 [info ] [Thread-1 (]: 2 of 6 START sql incremental model abu.d_customer_incremental_trs .............. [RUN]
[0m16:35:10.666766 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.666766 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_incremental_trs
[0m16:35:10.666766 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_incremental_trs
[0m16:35:10.671765 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.672766 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.672766 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_incremental_trs
[0m16:35:10.677766 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.677766 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

    
  
    

  create temporary table "d_customer_incremental_trs__dbt_tmp173510674767"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
    
    -- filter for an incremental run to get new data
    

    --where insertedat > (select max(insertedat) from "postgres"."abu"."d_customer_incremental_trs")

    

)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
  
[0m16:35:10.677766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:10.734776 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.06 seconds
[0m16:35:10.737776 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.737776 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: BEGIN
[0m16:35:10.740775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:35:10.740775 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.740775 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_trs__dbt_tmp173510674767'
        
      order by ordinal_position

  
[0m16:35:10.756776 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.02 seconds
[0m16:35:10.759775 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.759775 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_trs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:10.762775 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:35:10.764774 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.765775 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_incremental_trs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:10.767774 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m16:35:10.769776 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.770775 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.771775 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_incremental_trs"} */

      insert into "postgres"."abu"."d_customer_incremental_trs" ("customerid", "customername", "insertedat")
    (
        select "customerid", "customername", "insertedat"
        from "d_customer_incremental_trs__dbt_tmp173510674767"
    )


  
[0m16:35:10.772776 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:35:10.774774 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:35:10.774774 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_incremental_trs"
[0m16:35:10.774774 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: COMMIT
[0m16:35:10.775775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:35:10.776777 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.776777 [debug] [Thread-1 (]: On model.scenarios.d_customer_incremental_trs: Close
[0m16:35:10.777775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A6F9D50>]}
[0m16:35:10.777775 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model abu.d_customer_incremental_trs ......... [[32mINSERT 0 2[0m in 0.11s]
[0m16:35:10.779775 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_incremental_trs
[0m16:35:10.780801 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_prs
[0m16:35:10.780801 [info ] [Thread-1 (]: 3 of 6 START sql table model abu.d_customer_table_prs .......................... [RUN]
[0m16:35:10.781777 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_prs"
[0m16:35:10.782776 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_prs
[0m16:35:10.782776 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_prs
[0m16:35:10.785776 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_prs"
[0m16:35:10.786775 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.786775 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_prs
[0m16:35:10.797776 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_prs"
[0m16:35:10.798775 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:35:10.798775 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: BEGIN
[0m16:35:10.799775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:10.855806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:35:10.855806 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:35:10.856807 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_prs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:35:10.863807 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.01 seconds
[0m16:35:10.868806 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:35:10.869806 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs" rename to "d_customer_table_prs__dbt_backup"
[0m16:35:10.870806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:10.872806 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:35:10.873806 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
alter table "postgres"."abu"."d_customer_table_prs__dbt_tmp" rename to "d_customer_table_prs"
[0m16:35:10.874817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:10.883837 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:35:10.883837 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:35:10.883837 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: COMMIT
[0m16:35:10.885805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:35:10.889837 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_prs"
[0m16:35:10.889837 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_prs"} */
drop table if exists "postgres"."abu"."d_customer_table_prs__dbt_backup" cascade
[0m16:35:10.892804 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:35:10.893805 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.893805 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_prs: Close
[0m16:35:10.894804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A778730>]}
[0m16:35:10.895804 [info ] [Thread-1 (]: 3 of 6 OK created sql table model abu.d_customer_table_prs ..................... [[32mSELECT 4[0m in 0.11s]
[0m16:35:10.896803 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_prs
[0m16:35:10.897804 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_table_trs
[0m16:35:10.897804 [info ] [Thread-1 (]: 4 of 6 START sql table model abu.d_customer_table_trs .......................... [RUN]
[0m16:35:10.898804 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_table_trs"
[0m16:35:10.899804 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_table_trs
[0m16:35:10.899804 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_table_trs
[0m16:35:10.901803 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_table_trs"
[0m16:35:10.902803 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.903803 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_table_trs
[0m16:35:10.907804 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_table_trs"
[0m16:35:10.908803 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:35:10.908803 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: BEGIN
[0m16:35:10.908803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:10.960803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:35:10.960803 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:35:10.961803 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */

  
    

  create  table "postgres"."abu"."d_customer_table_trs__dbt_tmp"
  as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
  
[0m16:35:10.967804 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m16:35:10.969803 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:35:10.969803 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs" rename to "d_customer_table_trs__dbt_backup"
[0m16:35:10.970803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:10.972804 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:35:10.973803 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
alter table "postgres"."abu"."d_customer_table_trs__dbt_tmp" rename to "d_customer_table_trs"
[0m16:35:10.974805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:10.976803 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:35:10.976803 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:35:10.976803 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: COMMIT
[0m16:35:10.977804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:35:10.979803 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_table_trs"
[0m16:35:10.980803 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_table_trs"} */
drop table if exists "postgres"."abu"."d_customer_table_trs__dbt_backup" cascade
[0m16:35:10.982803 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:35:10.983804 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.983804 [debug] [Thread-1 (]: On model.scenarios.d_customer_table_trs: Close
[0m16:35:10.984803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A6519C0>]}
[0m16:35:10.985804 [info ] [Thread-1 (]: 4 of 6 OK created sql table model abu.d_customer_table_trs ..................... [[32mSELECT 2[0m in 0.09s]
[0m16:35:10.986804 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_table_trs
[0m16:35:10.987803 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_prs
[0m16:35:10.987803 [info ] [Thread-1 (]: 5 of 6 START sql view model abu.d_customer_view_prs ............................ [RUN]
[0m16:35:10.988804 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_prs"
[0m16:35:10.989819 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_prs
[0m16:35:10.989819 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_prs
[0m16:35:10.992804 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_prs"
[0m16:35:10.993804 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:10.993804 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_prs
[0m16:35:11.010803 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_prs"
[0m16:35:11.011803 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:35:11.012804 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: BEGIN
[0m16:35:11.012804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:11.066851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:35:11.067852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:35:11.067852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */

  create view "postgres"."abu"."d_customer_view_prs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:35:11.073852 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m16:35:11.076852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:35:11.076852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs" rename to "d_customer_view_prs__dbt_backup"
[0m16:35:11.077852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:11.079852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:35:11.079852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
alter table "postgres"."abu"."d_customer_view_prs__dbt_tmp" rename to "d_customer_view_prs"
[0m16:35:11.080851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:11.082850 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:35:11.082850 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:35:11.082850 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: COMMIT
[0m16:35:11.084854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:35:11.086852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_prs"
[0m16:35:11.086852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_prs"} */
drop view if exists "postgres"."abu"."d_customer_view_prs__dbt_backup" cascade
[0m16:35:11.088852 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:35:11.089852 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:11.089852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_prs: Close
[0m16:35:11.090852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A78F190>]}
[0m16:35:11.091852 [info ] [Thread-1 (]: 5 of 6 OK created sql view model abu.d_customer_view_prs ....................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:35:11.092880 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_prs
[0m16:35:11.092880 [debug] [Thread-1 (]: Began running node model.scenarios.d_customer_view_trs
[0m16:35:11.093853 [info ] [Thread-1 (]: 6 of 6 START sql view model abu.d_customer_view_trs ............................ [RUN]
[0m16:35:11.094852 [debug] [Thread-1 (]: Acquiring new postgres connection "model.scenarios.d_customer_view_trs"
[0m16:35:11.094852 [debug] [Thread-1 (]: Began compiling node model.scenarios.d_customer_view_trs
[0m16:35:11.094852 [debug] [Thread-1 (]: Compiling model.scenarios.d_customer_view_trs
[0m16:35:11.097852 [debug] [Thread-1 (]: Writing injected SQL for node "model.scenarios.d_customer_view_trs"
[0m16:35:11.098852 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:11.098852 [debug] [Thread-1 (]: Began executing node model.scenarios.d_customer_view_trs
[0m16:35:11.104852 [debug] [Thread-1 (]: Writing runtime sql for node "model.scenarios.d_customer_view_trs"
[0m16:35:11.105852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:35:11.105852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: BEGIN
[0m16:35:11.106853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:11.162852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m16:35:11.163862 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:35:11.163862 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */

  create view "postgres"."abu"."d_customer_view_trs__dbt_tmp" as (
    

with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c
  );
[0m16:35:11.169852 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:35:11.171850 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:35:11.172878 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs" rename to "d_customer_view_trs__dbt_backup"
[0m16:35:11.172878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:11.174851 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:35:11.175850 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
alter table "postgres"."abu"."d_customer_view_trs__dbt_tmp" rename to "d_customer_view_trs"
[0m16:35:11.175850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:35:11.177852 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:35:11.177852 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:35:11.178851 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: COMMIT
[0m16:35:11.179852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:35:11.181851 [debug] [Thread-1 (]: Using postgres connection "model.scenarios.d_customer_view_trs"
[0m16:35:11.181851 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "model.scenarios.d_customer_view_trs"} */
drop view if exists "postgres"."abu"."d_customer_view_trs__dbt_backup" cascade
[0m16:35:11.182851 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:35:11.183852 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:11.184851 [debug] [Thread-1 (]: On model.scenarios.d_customer_view_trs: Close
[0m16:35:11.184851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07095e76-4227-4649-9592-13a7e656a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A733490>]}
[0m16:35:11.185852 [info ] [Thread-1 (]: 6 of 6 OK created sql view model abu.d_customer_view_trs ....................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:35:11.187851 [debug] [Thread-1 (]: Finished running node model.scenarios.d_customer_view_trs
[0m16:35:11.188852 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:35:11.189852 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:11.189852 [debug] [MainThread]: On master: BEGIN
[0m16:35:11.189852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:11.246852 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:35:11.247852 [debug] [MainThread]: On master: COMMIT
[0m16:35:11.247852 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:11.247852 [debug] [MainThread]: On master: COMMIT
[0m16:35:11.248851 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:35:11.248851 [debug] [MainThread]: On master: Close
[0m16:35:11.249851 [info ] [MainThread]: 
[0m16:35:11.249851 [info ] [MainThread]: Finished running 2 incremental models, 2 table models, 2 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m16:35:11.251853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:11.252852 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:35:11.252852 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:35:11.252852 [debug] [MainThread]: Connection 'model.scenarios.d_customer_view_trs' was properly closed.
[0m16:35:11.260852 [info ] [MainThread]: 
[0m16:35:11.261852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:11.261852 [info ] [MainThread]: 
[0m16:35:11.262851 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:35:11.262851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A60F9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A7B0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3A7B1390>]}
[0m16:35:11.263851 [debug] [MainThread]: Flushing usage events
[0m16:35:11.442966 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.


============================== 2022-11-27 16:35:18.855306 | 2d3c99ab-7dd8-4d14-b72a-086c25648ec9 ==============================
[0m16:35:18.855306 [info ] [MainThread]: Running with dbt=1.3.0
[0m16:35:18.856307 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\buckena\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m16:35:18.856307 [debug] [MainThread]: Tracking: tracking
[0m16:35:18.877307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CC95BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CC95A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CC95BCA0>]}
[0m16:35:18.965342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:18.965342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:18.966340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.scenarios.example

[0m16:35:18.972306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d3c99ab-7dd8-4d14-b72a-086c25648ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCC0E950>]}
[0m16:35:18.979307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d3c99ab-7dd8-4d14-b72a-086c25648ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCA49BA0>]}
[0m16:35:18.980307 [info ] [MainThread]: Found 6 models, 0 tests, 2 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m16:35:18.980307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3c99ab-7dd8-4d14-b72a-086c25648ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCBE8250>]}
[0m16:35:18.982308 [info ] [MainThread]: 
[0m16:35:18.982308 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:35:18.985307 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m16:35:18.995340 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:35:18.995340 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:35:18.995340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:19.067309 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.07 seconds
[0m16:35:19.069308 [debug] [ThreadPool]: On list_postgres: Close
[0m16:35:19.071309 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_abu"
[0m16:35:19.076310 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:35:19.076310 [debug] [ThreadPool]: On list_postgres_abu: BEGIN
[0m16:35:19.076310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:19.129307 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m16:35:19.129307 [debug] [ThreadPool]: Using postgres connection "list_postgres_abu"
[0m16:35:19.130342 [debug] [ThreadPool]: On list_postgres_abu: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "list_postgres_abu"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'abu'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'abu'
  
[0m16:35:19.137307 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.01 seconds
[0m16:35:19.138306 [debug] [ThreadPool]: On list_postgres_abu: ROLLBACK
[0m16:35:19.138306 [debug] [ThreadPool]: On list_postgres_abu: Close
[0m16:35:19.143307 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:19.144306 [debug] [MainThread]: On master: BEGIN
[0m16:35:19.144306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:19.198307 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m16:35:19.198307 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:19.199339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:35:19.242306 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m16:35:19.244306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3c99ab-7dd8-4d14-b72a-086c25648ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CC95BF70>]}
[0m16:35:19.244306 [debug] [MainThread]: On master: ROLLBACK
[0m16:35:19.245306 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:19.245306 [debug] [MainThread]: On master: BEGIN
[0m16:35:19.245306 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:35:19.246307 [debug] [MainThread]: On master: COMMIT
[0m16:35:19.246307 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:19.246307 [debug] [MainThread]: On master: COMMIT
[0m16:35:19.247307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:35:19.247307 [debug] [MainThread]: On master: Close
[0m16:35:19.248307 [info ] [MainThread]: Concurrency: 1 threads (target='psq-dev')
[0m16:35:19.248307 [info ] [MainThread]: 
[0m16:35:19.259307 [debug] [Thread-1 (]: Began running node snapshot.scenarios.d_customer_snapshot_prs
[0m16:35:19.259307 [info ] [Thread-1 (]: 1 of 2 START snapshot abu.d_customer_snapshot_prs .............................. [RUN]
[0m16:35:19.260307 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.261306 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.d_customer_snapshot_prs
[0m16:35:19.261306 [debug] [Thread-1 (]: Compiling snapshot.scenarios.d_customer_snapshot_prs
[0m16:35:19.264306 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:19.264306 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.d_customer_snapshot_prs
[0m16:35:19.302335 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.303335 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: BEGIN
[0m16:35:19.303335 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:19.353307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:35:19.354343 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.354343 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_prs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:19.371307 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m16:35:19.393341 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.393341 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

        
  
    

  create temporary table "d_customer_snapshot_prs__dbt_tmp173519383306"
  as (
    with snapshot_query as (

        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_prs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c


    ),

    snapshotted_data as (

        select *,
            customerid as dbt_unique_key

        from "postgres"."abu"."d_customer_snapshot_prs"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            nullif(insertedat, insertedat) as dbt_valid_to,
            md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            insertedat as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.insertedat)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.insertedat)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:35:19.402307 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.01 seconds
[0m16:35:19.405217 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.405217 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_prs__dbt_tmp173519383306'
        
      order by ordinal_position

  
[0m16:35:19.408184 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:35:19.411218 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.411218 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_prs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:19.414184 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:35:19.417184 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.417184 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_prs__dbt_tmp173519383306'
        
      order by ordinal_position

  
[0m16:35:19.420184 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:35:19.423217 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.424219 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_prs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:19.427184 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:35:19.432217 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.433217 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_prs__dbt_tmp173519383306'
        
      order by ordinal_position

  
[0m16:35:19.436184 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:35:19.441223 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.442184 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.443199 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_prs"} */

      update "postgres"."abu"."d_customer_snapshot_prs"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "d_customer_snapshot_prs__dbt_tmp173519383306" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."abu"."d_customer_snapshot_prs".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."abu"."d_customer_snapshot_prs".dbt_valid_to is null;

    insert into "postgres"."abu"."d_customer_snapshot_prs" ("customerid", "customername", "insertedat", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customerid",DBT_INTERNAL_SOURCE."customername",DBT_INTERNAL_SOURCE."insertedat",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "d_customer_snapshot_prs__dbt_tmp173519383306" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:35:19.444184 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:35:19.456219 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: COMMIT
[0m16:35:19.457213 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_prs"
[0m16:35:19.457213 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: COMMIT
[0m16:35:19.459185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:35:19.461185 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:19.461185 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_prs: Close
[0m16:35:19.462185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3c99ab-7dd8-4d14-b72a-086c25648ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCD026E0>]}
[0m16:35:19.463187 [info ] [Thread-1 (]: 1 of 2 OK snapshotted abu.d_customer_snapshot_prs .............................. [[32mINSERT 0 2[0m in 0.20s]
[0m16:35:19.465186 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.d_customer_snapshot_prs
[0m16:35:19.465186 [debug] [Thread-1 (]: Began running node snapshot.scenarios.d_customer_snapshot_trs
[0m16:35:19.465186 [info ] [Thread-1 (]: 2 of 2 START snapshot abu.d_customer_snapshot_trs .............................. [RUN]
[0m16:35:19.466214 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.467183 [debug] [Thread-1 (]: Began compiling node snapshot.scenarios.d_customer_snapshot_trs
[0m16:35:19.467183 [debug] [Thread-1 (]: Compiling snapshot.scenarios.d_customer_snapshot_trs
[0m16:35:19.471212 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:19.471212 [debug] [Thread-1 (]: Began executing node snapshot.scenarios.d_customer_snapshot_trs
[0m16:35:19.475184 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.476218 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: BEGIN
[0m16:35:19.476218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:19.529183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m16:35:19.529183 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.530184 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_trs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:19.546184 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.02 seconds
[0m16:35:19.548184 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.549182 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

        
  
    

  create temporary table "d_customer_snapshot_trs__dbt_tmp173519548184"
  as (
    with snapshot_query as (

        



with w_cust as (
    select *
    from "postgres"."abu"."stg_customer_trs"
)
select c.customerid
     , c.customername
     , c.insertedat
from w_cust c


    ),

    snapshotted_data as (

        select *,
            customerid as dbt_unique_key

        from "postgres"."abu"."d_customer_snapshot_trs"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            nullif(insertedat, insertedat) as dbt_valid_to,
            md5(coalesce(cast(customerid as varchar ), '')
         || '|' || coalesce(cast(insertedat as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customerid as dbt_unique_key,
            insertedat as dbt_updated_at,
            insertedat as dbt_valid_from,
            insertedat as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.insertedat)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.insertedat)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:35:19.557184 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.01 seconds
[0m16:35:19.560183 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.560183 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_trs__dbt_tmp173519548184'
        
      order by ordinal_position

  
[0m16:35:19.563183 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:35:19.566183 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.566183 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_trs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:19.569184 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:35:19.572217 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.572217 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_trs__dbt_tmp173519548184'
        
      order by ordinal_position

  
[0m16:35:19.575183 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:35:19.577189 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.578217 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_trs'
        
        and table_schema = 'abu'
        
      order by ordinal_position

  
[0m16:35:19.580184 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m16:35:19.584220 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.584220 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'd_customer_snapshot_trs__dbt_tmp173519548184'
        
      order by ordinal_position

  
[0m16:35:19.587196 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.0 seconds
[0m16:35:19.589223 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.590217 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.591219 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "scenarios", "target_name": "psq-dev", "node_id": "snapshot.scenarios.d_customer_snapshot_trs"} */

      update "postgres"."abu"."d_customer_snapshot_trs"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "d_customer_snapshot_trs__dbt_tmp173519548184" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "postgres"."abu"."d_customer_snapshot_trs".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "postgres"."abu"."d_customer_snapshot_trs".dbt_valid_to is null;

    insert into "postgres"."abu"."d_customer_snapshot_trs" ("customerid", "customername", "insertedat", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customerid",DBT_INTERNAL_SOURCE."customername",DBT_INTERNAL_SOURCE."insertedat",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "d_customer_snapshot_trs__dbt_tmp173519548184" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:35:19.592223 [debug] [Thread-1 (]: SQL status: INSERT 0 2 in 0.0 seconds
[0m16:35:19.593216 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: COMMIT
[0m16:35:19.594217 [debug] [Thread-1 (]: Using postgres connection "snapshot.scenarios.d_customer_snapshot_trs"
[0m16:35:19.594217 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: COMMIT
[0m16:35:19.595183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:35:19.596210 [debug] [Thread-1 (]: finished collecting timing info
[0m16:35:19.596210 [debug] [Thread-1 (]: On snapshot.scenarios.d_customer_snapshot_trs: Close
[0m16:35:19.597213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3c99ab-7dd8-4d14-b72a-086c25648ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCD60040>]}
[0m16:35:19.597213 [info ] [Thread-1 (]: 2 of 2 OK snapshotted abu.d_customer_snapshot_trs .............................. [[32mINSERT 0 2[0m in 0.13s]
[0m16:35:19.599184 [debug] [Thread-1 (]: Finished running node snapshot.scenarios.d_customer_snapshot_trs
[0m16:35:19.601184 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m16:35:19.601184 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:19.602184 [debug] [MainThread]: On master: BEGIN
[0m16:35:19.602184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:19.659192 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m16:35:19.660157 [debug] [MainThread]: On master: COMMIT
[0m16:35:19.660157 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:19.661156 [debug] [MainThread]: On master: COMMIT
[0m16:35:19.661156 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:35:19.661156 [debug] [MainThread]: On master: Close
[0m16:35:19.662157 [info ] [MainThread]: 
[0m16:35:19.663156 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:35:19.666157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:19.666157 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:35:19.666157 [debug] [MainThread]: Connection 'list_postgres_abu' was properly closed.
[0m16:35:19.667156 [debug] [MainThread]: Connection 'snapshot.scenarios.d_customer_snapshot_trs' was properly closed.
[0m16:35:19.674157 [info ] [MainThread]: 
[0m16:35:19.674157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:19.676157 [info ] [MainThread]: 
[0m16:35:19.677157 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:35:19.677157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCB84040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCD600A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CCD4F760>]}
[0m16:35:19.678157 [debug] [MainThread]: Flushing usage events
[0m16:35:19.796640 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
